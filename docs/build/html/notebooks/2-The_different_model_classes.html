

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. The different model classes &mdash; hmp 1.0.0-b.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=12f248e0"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/tabs.js?v=3ee01567"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Applying HMP to real data" href="3-Applying_HMP_to_real_data.html" />
    <link rel="prev" title="1 How HMP works: practical, methodological and theoretical grounds" href="1-How_HMP_works.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/hmp.html">hmp package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1-How_HMP_works.html">1 How HMP works: practical, methodological and theoretical grounds</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. The different model classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Model-with-a-fixed-number-of-event-with-EventModel">Model with a fixed number of event with <code class="docutils literal notranslate"><span class="pre">EventModel</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Fit-transform">Fit transform</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Fixing-parameters">Fixing parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Informed-starting-points">Informed starting points</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Random-starting-points">Random starting points</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Eliminative-method">Eliminative method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Default-behavior">Default behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Providing-a-custom-maximum-model">Providing a custom maximum model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Define-a-range">Define a range</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Cumulative-event-fit">Cumulative event fit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Default behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#By-sample">By sample</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="3-Applying_HMP_to_real_data.html">3. Applying HMP to real data</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-advanced-multilevel_models.html">4. Advanced multilevel models</a></li>
<li class="toctree-l1"><a class="reference internal" href="5-advanced--model_selection.html">5. Performing model selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data_loading.html">Reading your own data</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hmp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">2. The different model classes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/2-The_different_model_classes.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="2.-The-different-model-classes">
<h1>2. The different model classes<a class="headerlink" href="#2.-The-different-model-classes" title="Link to this heading"></a></h1>
<p>This section will show you the different models implemented in HMP</p>
<p>First we simulate the data by calling the <code class="docutils literal notranslate"><span class="pre">demo</span></code> function, which is only used for this tutorial.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Running the demo function in the simulation module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hmp.simulations</span><span class="w"> </span><span class="kn">import</span> <span class="n">demo</span>
<span class="n">n_events</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#how many events to simulate</span>
<span class="n">epoch_data</span><span class="p">,</span> <span class="n">sim_source_times</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">demo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_events</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1">#You can change the seed and the overwrite argument if you want to play around with other random data</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    Read a total of 4 projection items:
        PCA-v1 (1 x 102) active
        PCA-v2 (1 x 102) active
        PCA-v3 (1 x 102) active
        Average EEG reference (1 x 60) active
Processing participant /home/gabriel/ownCloud/projects/RUGUU/hmp/docs/source/notebooks/sample_data/demo_dataset_raw.fif&#39;s raw eeg
50 trials were retained for participant /home/gabriel/ownCloud/projects/RUGUU/hmp/docs/source/notebooks/sample_data/demo_dataset_raw.fif
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/gabriel/ownCloud/projects/RUGUU/hmp/hmp/simulations.py:220: UserWarning: /home/gabriel/ownCloud/projects/RUGUU/hmp/docs/source/notebooks/sample_data/demo_dataset_raw.fif exists no new simulation performed
  warn(f&#34;{subj_file} exists no new simulation performed&#34;, UserWarning)
</pre></div></div>
</div>
<p>We preprocess the data as in Turorial 1 and we want 3 PC components (more on that for the next tutorial on real data):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">hmp.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Preprocessing</span>
<span class="n">preprocessed</span> <span class="o">=</span> <span class="n">Preprocessing</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">n_comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">preprocessed</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/gabriel/ownCloud/projects/RUGUU/hmp/hmp/preprocessing.py:196: UserWarning: Data will be modified inplace, re-read the data or use copy=True if multiplecalls to this function
  warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (component: 3, all_samples: 3566)&gt; Size: 86kB
array([[ 0.53560972,  0.19850657,  0.17567327, ...,  0.17766308,
         0.40572942,  0.47067545],
       [ 0.38244396,  0.56102823,  0.0798658 , ...,  0.88318528,
         1.45360032,  0.9394444 ],
       [-0.02622281, -0.14054032, -0.76716713, ..., -0.42271811,
        -0.50342972, -0.20295509]], shape=(3, 3566))
Coordinates:
    event_name   (all_samples) object 29kB &#x27;stimulus&#x27; &#x27;stimulus&#x27; ... &#x27;stimulus&#x27;
    rt           (all_samples) float64 29kB 0.79 0.79 0.79 ... 0.77 0.77 0.77
  * component    (component) int64 24B 0 1 2
  * all_samples  (all_samples) object 29kB MultiIndex
  * participant  (all_samples) &lt;U2 29kB &#x27;S0&#x27; &#x27;S0&#x27; &#x27;S0&#x27; &#x27;S0&#x27; ... &#x27;S0&#x27; &#x27;S0&#x27; &#x27;S0&#x27;
  * epoch        (all_samples) int64 29kB 0 0 0 0 0 0 0 ... 49 49 49 49 49 49 49
  * sample       (all_samples) int64 29kB 0 1 2 3 4 5 6 ... 72 73 74 75 76 77 78
Attributes:
    sfreq:    100.0
    offset:   2</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>component</span>: 3</li><li><span class='xr-has-index'>all_samples</span>: 3566</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-bd64a0c1-08d1-492b-9cd7-7ebaa8d41dbc' class='xr-array-in' type='checkbox' checked><label for='section-bd64a0c1-08d1-492b-9cd7-7ebaa8d41dbc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.5356 0.1985 0.1757 -0.432 -0.9215 ... -0.8454 -0.4227 -0.5034 -0.203</span></div><div class='xr-array-data'><pre>array([[ 0.53560972,  0.19850657,  0.17567327, ...,  0.17766308,
         0.40572942,  0.47067545],
       [ 0.38244396,  0.56102823,  0.0798658 , ...,  0.88318528,
         1.45360032,  0.9394444 ],
       [-0.02622281, -0.14054032, -0.76716713, ..., -0.42271811,
        -0.50342972, -0.20295509]], shape=(3, 3566))</pre></div></div></li><li class='xr-section-item'><input id='section-4eb84484-52ac-48ee-a53d-17345809e57a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4eb84484-52ac-48ee-a53d-17345809e57a' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>event_name</span></div><div class='xr-var-dims'>(all_samples)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;stimulus&#x27; ... &#x27;stimulus&#x27;</div><input id='attrs-f2ab2479-ae18-4e9a-871a-3dc4ad6f3f70' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f2ab2479-ae18-4e9a-871a-3dc4ad6f3f70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a21dd59b-0738-4fc7-a363-4069d0c49b49' class='xr-var-data-in' type='checkbox'><label for='data-a21dd59b-0738-4fc7-a363-4069d0c49b49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;stimulus&#x27;, &#x27;stimulus&#x27;, &#x27;stimulus&#x27;, ..., &#x27;stimulus&#x27;, &#x27;stimulus&#x27;,
       &#x27;stimulus&#x27;], shape=(3566,), dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rt</span></div><div class='xr-var-dims'>(all_samples)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.79 0.79 0.79 ... 0.77 0.77 0.77</div><input id='attrs-60bb4db2-1625-48f6-baa6-9fd5863930c4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-60bb4db2-1625-48f6-baa6-9fd5863930c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc2515e1-628e-4489-aeb2-de2d706471a9' class='xr-var-data-in' type='checkbox'><label for='data-cc2515e1-628e-4489-aeb2-de2d706471a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.79, 0.79, 0.79, ..., 0.77, 0.77, 0.77], shape=(3566,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>component</span></div><div class='xr-var-dims'>(component)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2</div><input id='attrs-48cf6330-329c-489b-ad44-141880e097e0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-48cf6330-329c-489b-ad44-141880e097e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e616cf5-bdb7-4d9b-8f7f-2ff474f602ff' class='xr-var-data-in' type='checkbox'><label for='data-1e616cf5-bdb7-4d9b-8f7f-2ff474f602ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 2])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>all_samples</span></div><div class='xr-var-dims'>(all_samples)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-0f98e704-3f3d-4e86-8833-501c65b1b825' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0f98e704-3f3d-4e86-8833-501c65b1b825' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3af9b75a-3a50-4413-82b7-3a205ddbeaf1' class='xr-var-data-in' type='checkbox'><label for='data-3af9b75a-3a50-4413-82b7-3a205ddbeaf1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([(&#x27;S0&#x27;, 0, 0), (&#x27;S0&#x27;, 0, 1), (&#x27;S0&#x27;, 0, 2), ..., (&#x27;S0&#x27;, 49, 76),
       (&#x27;S0&#x27;, 49, 77), (&#x27;S0&#x27;, 49, 78)], shape=(202,), dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>participant</span></div><div class='xr-var-dims'>(all_samples)</div><div class='xr-var-dtype'>&lt;U2</div><div class='xr-var-preview xr-preview'>&#x27;S0&#x27; &#x27;S0&#x27; &#x27;S0&#x27; ... &#x27;S0&#x27; &#x27;S0&#x27; &#x27;S0&#x27;</div><input id='attrs-e7e810c2-6cf7-4666-b432-22da6ab64d7e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e7e810c2-6cf7-4666-b432-22da6ab64d7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0db21f2-69ea-494b-a755-6fb3e68ddcfc' class='xr-var-data-in' type='checkbox'><label for='data-b0db21f2-69ea-494b-a755-6fb3e68ddcfc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;S0&#x27;, &#x27;S0&#x27;, &#x27;S0&#x27;, ..., &#x27;S0&#x27;, &#x27;S0&#x27;, &#x27;S0&#x27;], shape=(202,), dtype=&#x27;&lt;U2&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>epoch</span></div><div class='xr-var-dims'>(all_samples)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 ... 49 49 49 49 49 49</div><input id='attrs-be71b363-1bd9-47f6-bd56-554800dc8db4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-be71b363-1bd9-47f6-bd56-554800dc8db4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4a0ae648-b961-4675-8c6c-028ebcad8009' class='xr-var-data-in' type='checkbox'><label for='data-4a0ae648-b961-4675-8c6c-028ebcad8009' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  0,  0, ..., 49, 49, 49], shape=(202,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(all_samples)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 73 74 75 76 77 78</div><input id='attrs-f79543ee-6682-4bd6-b28d-56eda300b1e0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f79543ee-6682-4bd6-b28d-56eda300b1e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a2ac7c5-49c0-41e4-bb5d-51147e6a5299' class='xr-var-data-in' type='checkbox'><label for='data-3a2ac7c5-49c0-41e4-bb5d-51147e6a5299' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2, ..., 76, 77, 78], shape=(202,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6dacb853-5edb-4b74-bf06-67ca083ef670' class='xr-section-summary-in' type='checkbox'  ><label for='section-6dacb853-5edb-4b74-bf06-67ca083ef670' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>component</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-bbdde4c2-7a52-433b-9dbc-62a69e5330d1' class='xr-index-data-in' type='checkbox'/><label for='index-bbdde4c2-7a52-433b-9dbc-62a69e5330d1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1, 2], dtype=&#x27;int64&#x27;, name=&#x27;component&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>all_samples<br>participant<br>epoch<br>sample</div></div><div class='xr-index-preview'>PandasMultiIndex</div><input type='checkbox' disabled/><label></label><input id='index-7c0dc479-0b24-42ce-b60d-2cf801caeca7' class='xr-index-data-in' type='checkbox'/><label for='index-7c0dc479-0b24-42ce-b60d-2cf801caeca7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(MultiIndex([(&#x27;S0&#x27;,  0,  0),
            (&#x27;S0&#x27;,  0,  1),
            (&#x27;S0&#x27;,  0,  2),
            (&#x27;S0&#x27;,  0,  3),
            (&#x27;S0&#x27;,  0,  4),
            (&#x27;S0&#x27;,  0,  5),
            (&#x27;S0&#x27;,  0,  6),
            (&#x27;S0&#x27;,  0,  7),
            (&#x27;S0&#x27;,  0,  8),
            (&#x27;S0&#x27;,  0,  9),
            ...
            (&#x27;S0&#x27;, 49, 69),
            (&#x27;S0&#x27;, 49, 70),
            (&#x27;S0&#x27;, 49, 71),
            (&#x27;S0&#x27;, 49, 72),
            (&#x27;S0&#x27;, 49, 73),
            (&#x27;S0&#x27;, 49, 74),
            (&#x27;S0&#x27;, 49, 75),
            (&#x27;S0&#x27;, 49, 76),
            (&#x27;S0&#x27;, 49, 77),
            (&#x27;S0&#x27;, 49, 78)],
           name=&#x27;all_samples&#x27;, length=3566))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-795644fa-a84c-4a84-8bcb-9562fcee9e09' class='xr-section-summary-in' type='checkbox'  checked><label for='section-795644fa-a84c-4a84-8bcb-9562fcee9e09' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>sfreq :</span></dt><dd>100.0</dd><dt><span>offset :</span></dt><dd>2</dd></dl></div></li></ul></div></div></div>
</div>
<p>And we create a standard template and distribution as in Tutorial 1, this will be used for all the model classes</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">hmp.patterns</span><span class="w"> </span><span class="kn">import</span> <span class="n">HalfSine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hmp.distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Gamma</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hmp.trialdata</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrialData</span>

<span class="n">event_properties</span> <span class="o">=</span> <span class="n">HalfSine</span><span class="o">.</span><span class="n">create_expected</span><span class="p">(</span><span class="n">sfreq</span><span class="o">=</span><span class="n">epoch_data</span><span class="o">.</span><span class="n">sfreq</span><span class="p">)</span>
<span class="n">time_distribution</span> <span class="o">=</span> <span class="n">Gamma</span><span class="p">()</span>
<span class="n">trial_data</span> <span class="o">=</span> <span class="n">TrialData</span><span class="o">.</span><span class="n">from_preprocessed</span><span class="p">(</span><span class="n">preprocessed</span><span class="o">=</span><span class="n">preprocessed</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="n">event_properties</span><span class="o">.</span><span class="n">template</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Model-with-a-fixed-number-of-event-with-EventModel">
<h2>Model with a fixed number of event with <code class="docutils literal notranslate"><span class="pre">EventModel</span></code><a class="headerlink" href="#Model-with-a-fixed-number-of-event-with-EventModel" title="Link to this heading"></a></h2>
<p>This type of model is the <em>basic</em> model used by HMP. All subsequent ones call this class implicitely. The model works with an a priori number of events defined in the <code class="docutils literal notranslate"><span class="pre">n_events</span></code> parameter</p>
<p>The EM algorithm (see previous documentation section <a class="reference internal" href="1-How_HMP_works.html"><span class="doc">here</span></a>) is initiated with the starting point that all events are spread out evenly across the mean reaction time (RT) and that no channels are contributing to the events</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">hmp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">EventModel</span>

<span class="n">model_null</span> <span class="o">=</span> <span class="n">EventModel</span><span class="p">(</span><span class="n">event_properties</span><span class="p">,</span> <span class="n">time_distribution</span><span class="p">,</span> <span class="n">n_events</span><span class="o">=</span><span class="n">n_events</span><span class="p">,</span>
                        <span class="n">max_iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">#max_iteration=0 prevents from actually going through the EM</span>
<span class="n">model_null</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trial_data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="c1"># Just to illustrate the default starting points</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/gabriel/ownCloud/projects/RUGUU/hmp/hmp/models/event.py:559: RuntimeWarning: Convergence failed, estimation hit the maximum number of iterations: (0)
  warn(
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_null</span><span class="o">.</span><span class="n">time_pars</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[[2.        , 5.94333333],
        [2.        , 5.94333333],
        [2.        , 5.94333333],
        [2.        , 5.94333333],
        [2.        , 5.94333333],
        [2.        , 5.94333333]]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_null</span><span class="o">.</span><span class="n">channel_pars</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[[0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.]]])
</pre></div></div>
</div>
<section id="Fit-transform">
<h3>Fit transform<a class="headerlink" href="#Fit-transform" title="Link to this heading"></a></h3>
<p>As seen previously, when fitting an <code class="docutils literal notranslate"><span class="pre">EventModel</span></code> both the time and channel parameters will get updated depending on the data. The time parameters will be updated to reflect the expected time interval between each event, and the channel parameters will be updated to reflect the expected contribution of each channel to each event.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">EventModel</span><span class="p">(</span><span class="n">event_properties</span><span class="p">,</span> <span class="n">time_distribution</span><span class="p">,</span> <span class="n">n_events</span><span class="o">=</span><span class="n">n_events</span><span class="p">)</span>

<span class="c1">#Fitting</span>
<span class="n">loglikelihood</span><span class="p">,</span> <span class="n">estimates</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">)</span><span class="c1"># Fits the model and returns the estimates as event probabilities per sample</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Estimating 5 events model with 1 starting point(s)
</pre></div></div>
</div>
<p>Combined, these time and channel parameters define the event probabilities for each sample in the data.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">estimates</span></code> variable contains these probabilities, which can be visualized using the <code class="docutils literal notranslate"><span class="pre">plot_topo_timecourse</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">hmp.visu</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_topo_timecourse</span>
<span class="c1">#Visualizing</span>
<span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">times_to_display</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
           <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.LineCollection at 0x747e6c4ce660&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_15_1.png" src="../_images/notebooks_2-The_different_model_classes_15_1.png" />
</div>
</div>
<p>In this case HMP misses the 3rd event, which is not surprising as it is very close to the 2nd one. The reason is that the EM algorithm is sensitive to the starting points given to the relative event onsets. By default, the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method uses the starting point we illustrated above. We know that the last event is not at the RT so we could for example fix that parameter to avoid it being updated</p>
</section>
</section>
<section id="Fixing-parameters">
<h2>Fixing parameters<a class="headerlink" href="#Fixing-parameters" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_fixed</span> <span class="o">=</span> <span class="n">EventModel</span><span class="p">(</span><span class="n">event_properties</span><span class="p">,</span> <span class="n">time_distribution</span><span class="p">,</span> <span class="n">n_events</span><span class="o">=</span><span class="n">n_events</span><span class="p">,</span> <span class="n">fixed_time_pars</span><span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">fixed_channel_pars</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

<span class="c1">#Fitting</span>
<span class="n">ll_fixed</span><span class="p">,</span> <span class="n">estimates_fixed</span> <span class="o">=</span> <span class="n">model_fixed</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">)</span><span class="c1"># Fits the model and returns the estimates as event probabilities per sample</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Estimating 5 events model with 1 starting point(s)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Visualizing</span>
<span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates_fixed</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
           <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.LineCollection at 0x747e6cf7c620&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_19_1.png" src="../_images/notebooks_2-The_different_model_classes_19_1.png" />
</div>
</div>
<p>This doesn’t help as the 3rd event is still not found. The main reason why the HMP fit fails here is because the actual placement of the true events and the starting points are not appropriately exploring the parameter space. We could give a better guess for these starting points</p>
</section>
<section id="Informed-starting-points">
<h2>Informed starting points<a class="headerlink" href="#Informed-starting-points" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[[</span><span class="mf">2.</span>        <span class="p">,</span> <span class="mf">5.94333333</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">2.</span>        <span class="p">,</span> <span class="mf">5.94333333</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">2.</span>        <span class="p">,</span> <span class="mf">0.94333333</span><span class="p">],</span><span class="c1"># Expecting a shorter inter-event duration</span>
                        <span class="p">[</span><span class="mf">2.</span>        <span class="p">,</span> <span class="mf">5.94333333</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">2.</span>        <span class="p">,</span> <span class="mf">5.94333333</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">2.</span>        <span class="p">,</span> <span class="mf">10.94333333</span><span class="p">]]]])</span><span class="c1"># Expecting a longer inter-event duration</span>
<span class="c1"># Estimating an informed model</span>
<span class="n">ll_informed</span><span class="p">,</span> <span class="n">estimates_informed</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">,</span> <span class="n">time_pars</span><span class="o">=</span><span class="n">time_parameters</span><span class="p">)</span><span class="c1"># Providing the informed starting points</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Estimating 5 events model
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Visualizing</span>
<span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates_informed</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
           <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.LineCollection at 0x747e6c4cdd00&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_23_1.png" src="../_images/notebooks_2-The_different_model_classes_23_1.png" />
</div>
</div>
<p>Hooray, the 3rd event is now found! The reason is that the starting points are now more appropriate for the data. However, this is not always possible to know in advance, so we will now look at how to use random starting points.</p>
</section>
<section id="Random-starting-points">
<h2>Random starting points<a class="headerlink" href="#Random-starting-points" title="Link to this heading"></a></h2>
<p>Here we will just generate random time parameters to avoid leaving parameter space unexplored.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_random</span> <span class="o">=</span> <span class="n">EventModel</span><span class="p">(</span><span class="n">event_properties</span><span class="p">,</span> <span class="n">time_distribution</span><span class="p">,</span> <span class="n">n_events</span><span class="o">=</span><span class="n">n_events</span><span class="p">,</span>
                        <span class="n">starting_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_scale</span><span class="o">=</span><span class="n">trial_data</span><span class="o">.</span><span class="n">durations</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">ll_random</span><span class="p">,</span> <span class="n">estimates_random</span> <span class="o">=</span> <span class="n">model_random</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">,</span> <span class="n">cpus</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Estimating 5 events model with 100 starting point(s)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/lib/python3.12/multiprocessing/popen_fork.py:66: DeprecationWarning: This process (pid=337592) is multi-threaded, use of fork() may lead to deadlocks in the child.
  self.pid = os.fork()
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f98522da5e6a475591648bf4ce91d661", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">hmp.visu</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_topo_timecourse</span>
<span class="c1">#Visualizing</span>
<span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates_random</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
           <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.LineCollection at 0x747e6b5521b0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_28_1.png" src="../_images/notebooks_2-The_different_model_classes_28_1.png" />
</div>
</div>
<p>As you can see, the method discovered all events. But random starting points are not always the best solution, especially when the number of events is high or if the duration you model (e.g. RT) is very long. In that case, we can use the eliminative or cumulative estimation methods.</p>
</section>
<section id="Eliminative-method">
<h2>Eliminative method<a class="headerlink" href="#Eliminative-method" title="Link to this heading"></a></h2>
<p>Another solution is to first estimate a model with the maximal number of possible events that fit in RTs (referred to as ‘the maximal model’), and then decrease the number of events one by one.</p>
<p>The idea is that genuine events will necessarily be found at the expected locations in the maximal model. Because the backward estimation method iteratively removes the weakest event (in terms of likelihood), only the ‘strongest’ events remain even if their location would have been hard to find with a single fit and default starting values.</p>
<p>In order to do this we will use the <code class="docutils literal notranslate"><span class="pre">EliminativeMethod</span></code>. This function first estimates the maximal number of event (defined based on the event width and the minimum reaction time) using an <code class="docutils literal notranslate"><span class="pre">EventModel</span></code>, then estimates the max_event - 1 solution by iteratively removing one of the events and picking the solution with the highest likelihood (for more details see Borst &amp; Anderson, <a class="reference external" href="http://jelmerborst.nl/pubs/ACTR_hmp_MVPA_BorstAnderson_preprint.pdf">2021</a>) and repeat this until the 1 event
solution is reached.</p>
<section id="Default-behavior">
<h3>Default behavior<a class="headerlink" href="#Default-behavior" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">hmp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">EliminativeMethod</span>

<span class="n">elim_model</span> <span class="o">=</span> <span class="n">EliminativeMethod</span><span class="p">(</span><span class="n">event_properties</span><span class="p">,</span> <span class="n">time_distribution</span><span class="p">)</span>
<span class="n">ll_elim</span><span class="p">,</span> <span class="n">estimates_elim</span> <span class="o">=</span> <span class="n">elim_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Estimating all solutions for maximal number of events (10)
Estimating all solutions for 9 events
Estimating all solutions for 8 events
Estimating all solutions for 7 events
Estimating all solutions for 6 events
Estimating all solutions for 5 events
Estimating all solutions for 4 events
Estimating all solutions for 3 events
Estimating all solutions for 2 events
Estimating all solutions for 1 events
</pre></div></div>
</div>
<p>Here we plot the resulting solutions going from the maximal possible number of events (here 10 given the simulated average RT) all the way to a single event.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">estimates_elim</span><span class="o">.</span><span class="n">n_events</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">estimates_elim</span><span class="o">.</span><span class="n">n_events</span><span class="p">)),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">n_event</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">estimates_elim</span><span class="o">.</span><span class="n">n_events</span><span class="p">):</span>
    <span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates_elim</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">n_events</span><span class="o">=</span><span class="n">n_event</span><span class="p">),</span> <span class="n">info</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_events</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N = </span><span class="si">{</span><span class="n">n_event</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_35_0.png" src="../_images/notebooks_2-The_different_model_classes_35_0.png" />
</div>
</div>
<p>We can see that the maximal model contains the true topograpies and also some false alarms as we requested too many events compared to the true ones. We see that at each removal one of these false alarm gets removed.</p>
<p>From the solutions of the backward estimation we can select the number of events we originally wanted to estimate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected</span> <span class="o">=</span> <span class="n">estimates_elim</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">n_events</span><span class="o">=</span><span class="n">n_events</span><span class="p">)</span>
<span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">selected</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
           <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_events</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.LineCollection at 0x747ed0dfaf60&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_37_1.png" src="../_images/notebooks_2-The_different_model_classes_37_1.png" />
</div>
</div>
<p>Note however that this is not the maximum likelihood solution, in fact in this example if we look at the log-likelihood of the different solutions we can see that the maximum likelihood solution is actually the 6 events solution as seen in the plot below. The likelihood is evolving in a complex manner with the number of events. On the one hand adding events tends to increase the likelihood, on the other hand if events start to compete for samples (see the maximum model where the third event is
split in two), the likelihood can decrease. This is why we can see that the likelihood is not monotonically increasing with the number of events.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_events_backward</span> <span class="o">=</span> <span class="p">[</span><span class="n">elim_model</span><span class="o">.</span><span class="n">submodels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_events</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">elim_model</span><span class="o">.</span><span class="n">submodels</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_events_backward</span><span class="p">,</span> <span class="n">ll_elim</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">n_events</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ll_elim</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ll_elim</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of events&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Log-likelihood&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Log-likelihood&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_39_1.png" src="../_images/notebooks_2-The_different_model_classes_39_1.png" />
</div>
</div>
</section>
<section id="Providing-a-custom-maximum-model">
<h3>Providing a custom maximum model<a class="headerlink" href="#Providing-a-custom-maximum-model" title="Link to this heading"></a></h3>
<p>Instead of re-estimating a model with a maximum bumber of events we can provide a custom maximum model. This is useful if we know that the maximum number of events is lower than the one estimated by the <code class="docutils literal notranslate"><span class="pre">EliminativeMethod</span></code> class or if we want to depart from a specific model. In this case, we can provide a custom <code class="docutils literal notranslate"><span class="pre">EventModel</span></code> to the <code class="docutils literal notranslate"><span class="pre">EliminativeMethod</span></code> class and start the elimination from there.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elim_model_custom</span> <span class="o">=</span> <span class="n">EliminativeMethod</span><span class="p">(</span><span class="n">event_properties</span><span class="p">,</span> <span class="n">time_distribution</span><span class="p">)</span>
<span class="n">ll_elim_custom</span><span class="p">,</span> <span class="n">estimates_elim_custom</span> <span class="o">=</span> <span class="n">elim_model_custom</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">,</span> <span class="n">base_fit</span><span class="o">=</span><span class="n">model</span><span class="p">)</span><span class="c1">#Here we use the `model` we fitted above as the base model</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Estimating all solutions for 4 events
Estimating all solutions for 3 events
Estimating all solutions for 2 events
Estimating all solutions for 1 events
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">estimates_elim_custom</span><span class="o">.</span><span class="n">n_events</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">estimates_elim_custom</span><span class="o">.</span><span class="n">n_events</span><span class="p">)),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">n_event</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">estimates_elim_custom</span><span class="o">.</span><span class="n">n_events</span><span class="p">):</span>
    <span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates_elim_custom</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">n_events</span><span class="o">=</span><span class="n">n_event</span><span class="p">),</span> <span class="n">info</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_events</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N = </span><span class="si">{</span><span class="n">n_event</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_43_0.png" src="../_images/notebooks_2-The_different_model_classes_43_0.png" />
</div>
</div>
</section>
<section id="Define-a-range">
<h3>Define a range<a class="headerlink" href="#Define-a-range" title="Link to this heading"></a></h3>
<p>Alternatively we can also specify a range if we don’t want to fully explore all solutions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elim_model_range</span> <span class="o">=</span> <span class="n">EliminativeMethod</span><span class="p">(</span><span class="n">event_properties</span><span class="p">,</span> <span class="n">time_distribution</span><span class="p">)</span>
<span class="n">ll_range</span><span class="p">,</span> <span class="n">estimates_range</span> <span class="o">=</span> <span class="n">elim_model_range</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">,</span>  <span class="n">max_events</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">min_events</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Estimating all solutions for maximal number of events (8)
Estimating all solutions for 7 events
Estimating all solutions for 6 events
Estimating all solutions for 5 events
Estimating all solutions for 4 events
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">estimates_range</span><span class="o">.</span><span class="n">n_events</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">estimates_range</span><span class="o">.</span><span class="n">n_events</span><span class="p">)),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">n_event</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">estimates_range</span><span class="o">.</span><span class="n">n_events</span><span class="p">):</span>
    <span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates_range</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">n_events</span><span class="o">=</span><span class="n">n_event</span><span class="p">),</span> <span class="n">info</span><span class="p">,</span> <span class="n">sensors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
              <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_events</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_events</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N = </span><span class="si">{</span><span class="n">n_event</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_47_0.png" src="../_images/notebooks_2-The_different_model_classes_47_0.png" />
</div>
</div>
</section>
</section>
<section id="Cumulative-event-fit">
<h2>Cumulative event fit<a class="headerlink" href="#Cumulative-event-fit" title="Link to this heading"></a></h2>
<p>Instead of fitting an <em>n</em> event model this method starts by fitting a 1 event model using each sample from the time 0 (stimulus onset) to the mean RT. Therefore it tests for the landing point of the expectation maximization algorithm given each sample as starting point and the likelihood associated with this landing point. As soon as a starting points reaches the convergence criterion, the function fits an <em>n+1</em> event model and uses the next samples in the RT for the following event, etc.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">hmp.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">CumulativeMethod</span>
</pre></div>
</div>
</div>
<section id="id1">
<h3>Default behavior<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_cumulative</span> <span class="o">=</span> <span class="n">CumulativeMethod</span><span class="p">(</span><span class="n">event_properties</span><span class="p">)</span>
<span class="n">ll_cumulative</span><span class="p">,</span> <span class="n">estimates_cumulative</span> <span class="o">=</span> <span class="n">model_cumulative</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1dc9ae8e1e9f47939a1b795f3bc30713", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Transition event 1 found around time 130.0
Transition event 2 found around time 220.0
Transition event 3 found around time 390.0
Transition event 4 found around time 520.0

All events found, refitting final combination.
Estimating 4 events model
</pre></div></div>
</div>
<p>The following cell displays what happened when we fitted the model, as you can see the model iteratively adds events to the model, starting with the one event and a proposal at the first sample, after this event reached a local maxima, the algorithm adds another event just after until convergence, etc. Any additional event that decreases likelihood gets rejected (see the last row).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_cumulative</span><span class="o">.</span><span class="n">submodels</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_cumulative</span><span class="o">.</span><span class="n">submodels</span><span class="p">)),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">model_cumulative</span><span class="o">.</span><span class="n">submodels</span><span class="p">):</span>
    <span class="n">lkh_i</span><span class="p">,</span> <span class="n">estimates_i</span> <span class="o">=</span> <span class="n">model_cumulative</span><span class="o">.</span><span class="n">submodels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">)</span>
    <span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates_i</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span>
                        <span class="n">times_to_display</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                        <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N = </span><span class="si">{</span><span class="n">model_cumulative</span><span class="o">.</span><span class="n">submodels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_events</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_54_0.png" src="../_images/notebooks_2-The_different_model_classes_54_0.png" />
</div>
</div>
<p>We can look how the likelihood unfolded. HMP automatically stops for the best model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumulative_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">model_cumulative</span><span class="o">.</span><span class="n">submodels</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">n_events</span><span class="p">,</span> <span class="n">model_cumulative</span><span class="o">.</span><span class="n">submodels</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">lkhs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">model_cumulative</span><span class="o">.</span><span class="n">submodels</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cumulative_res</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">cumulative_res</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model_cumulative</span><span class="o">.</span><span class="n">final_model</span><span class="o">.</span><span class="n">n_events</span><span class="p">,</span> <span class="n">model_cumulative</span><span class="o">.</span><span class="n">final_model</span><span class="o">.</span><span class="n">lkhs</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted model likelihood&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x747ed18d5700&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_56_1.png" src="../_images/notebooks_2-The_different_model_classes_56_1.png" />
</div>
</div>
<p>As you can see the cumulative estimation missed the third event. This is likely because the third event is very close to the second one and the algorithm instead jumped to the fourth event. This is a behavior that we do not regularly observe on real data, nevertheless to avoid this behavior we can use the <code class="docutils literal notranslate"><span class="pre">by_sample</span></code> argument to fit the model sample by sample instead of jumping to the next highest likelihood event and ignoring the samples in between.</p>
</section>
<section id="By-sample">
<h3>By sample<a class="headerlink" href="#By-sample" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_cumulative</span> <span class="o">=</span> <span class="n">CumulativeMethod</span><span class="p">(</span><span class="n">event_properties</span><span class="p">,</span> <span class="n">by_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model_cumulative</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trial_data</span><span class="p">)</span>
<span class="n">ll_cumulative</span><span class="p">,</span> <span class="n">estimates_cumulative</span> <span class="o">=</span> <span class="n">model_cumulative</span><span class="o">.</span><span class="n">final_model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">trial_data</span><span class="p">)</span>
<span class="n">plot_topo_timecourse</span><span class="p">(</span><span class="n">epoch_data</span><span class="p">,</span> <span class="n">estimates_cumulative</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span>
                                <span class="n">times_to_display</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">sim_source_times</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">magnify</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "133a0f82f2fe4fbe9f431294eb2fee8d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Transition event 1 found around time 130.0
Transition event 2 found around time 220.0
Transition event 3 found around time 520.0
Transition event 4 found around time 520.0
Transition event 5 found around time 520.0

All events found, refitting final combination.
Estimating 5 events model
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_2-The_different_model_classes_59_2.png" src="../_images/notebooks_2-The_different_model_classes_59_2.png" />
</div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="1-How_HMP_works.html" class="btn btn-neutral float-left" title="1 How HMP works: practical, methodological and theoretical grounds" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="3-Applying_HMP_to_real_data.html" class="btn btn-neutral float-right" title="3. Applying HMP to real data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Gabriel Weindel, Maarten Schermer, Raoul Schram, Leendert van Maanen, Jelmer Borst.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>