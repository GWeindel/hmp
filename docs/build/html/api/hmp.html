

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hmp package &mdash; hmp 1.0.0-b.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=12f248e0"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/tabs.js?v=3ee01567"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Eliminative estimation method" href="hmp.models.html" />
    <link rel="prev" title="Installation Guide" href="../installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">hmp package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hmp.models.html"><code class="docutils literal notranslate"><span class="pre">EventModel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hmp.models.html#eliminative-estimation-method">Eliminative estimation method</a></li>
<li class="toctree-l3"><a class="reference internal" href="hmp.models.html#module-hmp.models.cumulative">Cumulative estimation method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#input-output-module">Input/output module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.io.hmp_data_format"><code class="docutils literal notranslate"><span class="pre">hmp_data_format()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.io.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.io.load_xr"><code class="docutils literal notranslate"><span class="pre">load_xr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.io.read_mne_data"><code class="docutils literal notranslate"><span class="pre">read_mne_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.io.read_raw_and_epoch"><code class="docutils literal notranslate"><span class="pre">read_raw_and_epoch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.io.save"><code class="docutils literal notranslate"><span class="pre">save()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.io.save_eventprobs_csv"><code class="docutils literal notranslate"><span class="pre">save_eventprobs_csv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.io.save_xr"><code class="docutils literal notranslate"><span class="pre">save_xr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#distributions-module">Distributions module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.distributions.Gamma"><code class="docutils literal notranslate"><span class="pre">Gamma</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Gamma.shape"><code class="docutils literal notranslate"><span class="pre">Gamma.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Gamma.pdf"><code class="docutils literal notranslate"><span class="pre">Gamma.pdf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Gamma.scale_to_mean"><code class="docutils literal notranslate"><span class="pre">Gamma.scale_to_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Gamma.mean_to_scale"><code class="docutils literal notranslate"><span class="pre">Gamma.mean_to_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">Gamma.mean_to_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">Gamma.scale_to_mean()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.distributions.Lognorm"><code class="docutils literal notranslate"><span class="pre">Lognorm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Lognorm.shape"><code class="docutils literal notranslate"><span class="pre">Lognorm.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Lognorm.pdf"><code class="docutils literal notranslate"><span class="pre">Lognorm.pdf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Lognorm.scale_to_mean"><code class="docutils literal notranslate"><span class="pre">Lognorm.scale_to_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Lognorm.mean_to_scale"><code class="docutils literal notranslate"><span class="pre">Lognorm.mean_to_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">Lognorm.mean_to_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">Lognorm.scale_to_mean()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.distributions.Wald"><code class="docutils literal notranslate"><span class="pre">Wald</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Wald.shape"><code class="docutils literal notranslate"><span class="pre">Wald.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Wald.pdf"><code class="docutils literal notranslate"><span class="pre">Wald.pdf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Wald.scale_to_mean"><code class="docutils literal notranslate"><span class="pre">Wald.scale_to_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Wald.mean_to_scale"><code class="docutils literal notranslate"><span class="pre">Wald.mean_to_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">Wald.mean_to_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">Wald.scale_to_mean()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.distributions.Weibull"><code class="docutils literal notranslate"><span class="pre">Weibull</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Weibull.shape"><code class="docutils literal notranslate"><span class="pre">Weibull.shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Weibull.pdf"><code class="docutils literal notranslate"><span class="pre">Weibull.pdf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Weibull.scale_to_mean"><code class="docutils literal notranslate"><span class="pre">Weibull.scale_to_mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.distributions.Weibull.mean_to_scale"><code class="docutils literal notranslate"><span class="pre">Weibull.mean_to_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">Weibull.mean_to_scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">Weibull.scale_to_mean()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#patterns-module">Patterns module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.patterns.Arbitrary"><code class="docutils literal notranslate"><span class="pre">Arbitrary</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.Arbitrary.sfreq"><code class="docutils literal notranslate"><span class="pre">Arbitrary.sfreq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.Arbitrary.width_samples"><code class="docutils literal notranslate"><span class="pre">Arbitrary.width_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.Arbitrary.location"><code class="docutils literal notranslate"><span class="pre">Arbitrary.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.Arbitrary.template"><code class="docutils literal notranslate"><span class="pre">Arbitrary.template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.Arbitrary.create_expected"><code class="docutils literal notranslate"><span class="pre">Arbitrary.create_expected()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">Arbitrary.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">Arbitrary.sfreq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">Arbitrary.template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">Arbitrary.width_samples</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.patterns.HalfSine"><code class="docutils literal notranslate"><span class="pre">HalfSine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.HalfSine.sfreq"><code class="docutils literal notranslate"><span class="pre">HalfSine.sfreq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.HalfSine.width_samples"><code class="docutils literal notranslate"><span class="pre">HalfSine.width_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.HalfSine.location"><code class="docutils literal notranslate"><span class="pre">HalfSine.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.HalfSine.template"><code class="docutils literal notranslate"><span class="pre">HalfSine.template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.patterns.HalfSine.create_expected"><code class="docutils literal notranslate"><span class="pre">HalfSine.create_expected()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">HalfSine.location</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">HalfSine.sfreq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">HalfSine.template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">HalfSine.width_samples</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hmp.preprocessing">Preprocessing module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.preprocessing.AnalysisMethod"><code class="docutils literal notranslate"><span class="pre">AnalysisMethod</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.AnalysisMethod.MCCA"><code class="docutils literal notranslate"><span class="pre">AnalysisMethod.MCCA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.AnalysisMethod.NO_ANALYSIS"><code class="docutils literal notranslate"><span class="pre">AnalysisMethod.NO_ANALYSIS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.AnalysisMethod.PCA"><code class="docutils literal notranslate"><span class="pre">AnalysisMethod.PCA</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.AnalysisMethod.parse"><code class="docutils literal notranslate"><span class="pre">AnalysisMethod.parse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.preprocessing.ApplyZScore"><code class="docutils literal notranslate"><span class="pre">ApplyZScore</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.ApplyZScore.ALL"><code class="docutils literal notranslate"><span class="pre">ApplyZScore.ALL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.ApplyZScore.DONT_APPLY"><code class="docutils literal notranslate"><span class="pre">ApplyZScore.DONT_APPLY</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.ApplyZScore.PARTICIPANT"><code class="docutils literal notranslate"><span class="pre">ApplyZScore.PARTICIPANT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.ApplyZScore.TRIAL"><code class="docutils literal notranslate"><span class="pre">ApplyZScore.TRIAL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.ApplyZScore.parse"><code class="docutils literal notranslate"><span class="pre">ApplyZScore.parse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.preprocessing.Preprocessing"><code class="docutils literal notranslate"><span class="pre">Preprocessing</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.Preprocessing.stack_data"><code class="docutils literal notranslate"><span class="pre">Preprocessing.stack_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.preprocessing.Preprocessing.zscore_xarray"><code class="docutils literal notranslate"><span class="pre">Preprocessing.zscore_xarray()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.preprocessing.user_input_n_comp"><code class="docutils literal notranslate"><span class="pre">user_input_n_comp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hmp.trialdata">TrialData module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.trialdata.TrialData"><code class="docutils literal notranslate"><span class="pre">TrialData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.named_durations"><code class="docutils literal notranslate"><span class="pre">TrialData.named_durations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.coords"><code class="docutils literal notranslate"><span class="pre">TrialData.coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.starts"><code class="docutils literal notranslate"><span class="pre">TrialData.starts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.ends"><code class="docutils literal notranslate"><span class="pre">TrialData.ends</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.n_trials"><code class="docutils literal notranslate"><span class="pre">TrialData.n_trials</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.n_samples"><code class="docutils literal notranslate"><span class="pre">TrialData.n_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.sfreq"><code class="docutils literal notranslate"><span class="pre">TrialData.sfreq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.offset"><code class="docutils literal notranslate"><span class="pre">TrialData.offset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.cross_corr"><code class="docutils literal notranslate"><span class="pre">TrialData.cross_corr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.trial_coords"><code class="docutils literal notranslate"><span class="pre">TrialData.trial_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">TrialData.coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">TrialData.cross_corr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.durations"><code class="docutils literal notranslate"><span class="pre">TrialData.durations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">TrialData.ends</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.from_preprocessed"><code class="docutils literal notranslate"><span class="pre">TrialData.from_preprocessed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.trialdata.TrialData.n_dims"><code class="docutils literal notranslate"><span class="pre">TrialData.n_dims</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">TrialData.n_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">TrialData.n_trials</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">TrialData.named_durations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">TrialData.offset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">TrialData.sfreq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">TrialData.starts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">TrialData.trial_coords</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.trialdata.cross_correlation"><code class="docutils literal notranslate"><span class="pre">cross_correlation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#visualization-module">Visualization module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.visu.erp_data"><code class="docutils literal notranslate"><span class="pre">erp_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.visu.plot_components_sensor"><code class="docutils literal notranslate"><span class="pre">plot_components_sensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.visu.plot_erp"><code class="docutils literal notranslate"><span class="pre">plot_erp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.visu.plot_latencies"><code class="docutils literal notranslate"><span class="pre">plot_latencies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.visu.plot_loocv"><code class="docutils literal notranslate"><span class="pre">plot_loocv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.visu.plot_topo_timecourse"><code class="docutils literal notranslate"><span class="pre">plot_topo_timecourse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hmp.utils">Utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.centered_activity"><code class="docutils literal notranslate"><span class="pre">centered_activity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.condition_selection"><code class="docutils literal notranslate"><span class="pre">condition_selection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.condition_selection_epoch"><code class="docutils literal notranslate"><span class="pre">condition_selection_epoch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.event_channels"><code class="docutils literal notranslate"><span class="pre">event_channels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.event_times"><code class="docutils literal notranslate"><span class="pre">event_times()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.participant_selection"><code class="docutils literal notranslate"><span class="pre">participant_selection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.stack_data"><code class="docutils literal notranslate"><span class="pre">stack_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.transform_data"><code class="docutils literal notranslate"><span class="pre">transform_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.utils.zscore_xarray"><code class="docutils literal notranslate"><span class="pre">zscore_xarray()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hmp.simulations">Simulations module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.available_sources"><code class="docutils literal notranslate"><span class="pre">available_sources()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.classification_true"><code class="docutils literal notranslate"><span class="pre">classification_true()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.demo"><code class="docutils literal notranslate"><span class="pre">demo()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.event_shape"><code class="docutils literal notranslate"><span class="pre">event_shape()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.positions"><code class="docutils literal notranslate"><span class="pre">positions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.sfreq"><code class="docutils literal notranslate"><span class="pre">sfreq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.sim_info"><code class="docutils literal notranslate"><span class="pre">sim_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.simulate"><code class="docutils literal notranslate"><span class="pre">simulate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.simulations.simulated_times_and_parameters"><code class="docutils literal notranslate"><span class="pre">simulated_times_and_parameters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hmp.loocv">LOOCV module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.backward_func"><code class="docutils literal notranslate"><span class="pre">backward_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.example_complex_fit_n_func"><code class="docutils literal notranslate"><span class="pre">example_complex_fit_n_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.example_fit_n_func"><code class="docutils literal notranslate"><span class="pre">example_fit_n_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.fit_backward_func"><code class="docutils literal notranslate"><span class="pre">fit_backward_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.loocv"><code class="docutils literal notranslate"><span class="pre">loocv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.loocv_backward"><code class="docutils literal notranslate"><span class="pre">loocv_backward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.loocv_calcs"><code class="docutils literal notranslate"><span class="pre">loocv_calcs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.loocv_estimate_func"><code class="docutils literal notranslate"><span class="pre">loocv_estimate_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.loocv_fit_backward"><code class="docutils literal notranslate"><span class="pre">loocv_fit_backward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.loocv_func"><code class="docutils literal notranslate"><span class="pre">loocv_func()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmp.loocv.loocv_loglikelihood"><code class="docutils literal notranslate"><span class="pre">loocv_loglikelihood()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-hmp.mcca">MCCA module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hmp.mcca.MCCA"><code class="docutils literal notranslate"><span class="pre">MCCA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hmp.mcca.MCCA.mu"><code class="docutils literal notranslate"><span class="pre">MCCA.mu</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.mcca.MCCA.sigma"><code class="docutils literal notranslate"><span class="pre">MCCA.sigma</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.mcca.MCCA.pca_weights"><code class="docutils literal notranslate"><span class="pre">MCCA.pca_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.mcca.MCCA.mcca_weights"><code class="docutils literal notranslate"><span class="pre">MCCA.mcca_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.mcca.MCCA.obtain_mcca"><code class="docutils literal notranslate"><span class="pre">MCCA.obtain_mcca()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.mcca.MCCA.obtain_mcca_cov"><code class="docutils literal notranslate"><span class="pre">MCCA.obtain_mcca_cov()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#hmp.mcca.MCCA.transform_trials"><code class="docutils literal notranslate"><span class="pre">MCCA.transform_trials()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/1-How_HMP_works.html">1 How HMP works: practical, methodological and theoretical grounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/2-The_different_model_classes.html">2. The different model classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/3-Applying_HMP_to_real_data.html">3. Applying HMP to real data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/4-advanced-multilevel_models.html">4. Advanced multilevel models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/5-advanced--model_selection.html">5. Performing model selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/Data_loading.html">Reading your own data</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hmp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">hmp package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/hmp.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hmp-package">
<h1>hmp package<a class="headerlink" href="#hmp-package" title="Link to this heading"></a></h1>
<p>Welcome to the HMP API documentation!</p>
<section id="models">
<h2>Models<a class="headerlink" href="#models" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="hmp.models.html"><code class="docutils literal notranslate"><span class="pre">EventModel</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.EM"><code class="docutils literal notranslate"><span class="pre">EventModel.EM()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.distribution_pdf"><code class="docutils literal notranslate"><span class="pre">EventModel.distribution_pdf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.estim_probs"><code class="docutils literal notranslate"><span class="pre">EventModel.estim_probs()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.fit"><code class="docutils literal notranslate"><span class="pre">EventModel.fit()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.gen_random_stages"><code class="docutils literal notranslate"><span class="pre">EventModel.gen_random_stages()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.get_channel_time_parameters_expectation"><code class="docutils literal notranslate"><span class="pre">EventModel.get_channel_time_parameters_expectation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.level_constructor"><code class="docutils literal notranslate"><span class="pre">EventModel.level_constructor()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.scale_parameters"><code class="docutils literal notranslate"><span class="pre">EventModel.scale_parameters()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.transform"><code class="docutils literal notranslate"><span class="pre">EventModel.transform()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.xrchannel_pars"><code class="docutils literal notranslate"><span class="pre">EventModel.xrchannel_pars</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.xrlikelihoods"><code class="docutils literal notranslate"><span class="pre">EventModel.xrlikelihoods</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.xrtime_pars"><code class="docutils literal notranslate"><span class="pre">EventModel.xrtime_pars</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.xrtime_pars_dev"><code class="docutils literal notranslate"><span class="pre">EventModel.xrtime_pars_dev</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.event.EventModel.xrtraces"><code class="docutils literal notranslate"><span class="pre">EventModel.xrtraces</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hmp.models.html#eliminative-estimation-method">Eliminative estimation method</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.eliminative.EliminativeMethod"><code class="docutils literal notranslate"><span class="pre">EliminativeMethod</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="hmp.models.html#hmp.models.eliminative.EliminativeMethod.fit"><code class="docutils literal notranslate"><span class="pre">EliminativeMethod.fit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hmp.models.html#hmp.models.eliminative.EliminativeMethod.get_fixed_model"><code class="docutils literal notranslate"><span class="pre">EliminativeMethod.get_fixed_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hmp.models.html#hmp.models.eliminative.EliminativeMethod.transform"><code class="docutils literal notranslate"><span class="pre">EliminativeMethod.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hmp.models.html#module-hmp.models.cumulative">Cumulative estimation method</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hmp.models.html#hmp.models.cumulative.CumulativeMethod"><code class="docutils literal notranslate"><span class="pre">CumulativeMethod</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="hmp.models.html#hmp.models.cumulative.CumulativeMethod.fit"><code class="docutils literal notranslate"><span class="pre">CumulativeMethod.fit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hmp.models.html#hmp.models.cumulative.CumulativeMethod.transform"><code class="docutils literal notranslate"><span class="pre">CumulativeMethod.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="input-output-module">
<h2>Input/output module<a class="headerlink" href="#input-output-module" title="Link to this heading"></a></h2>
<p id="module-hmp.io">EEG/MEG Data Processing Utilities.</p>
<p>This module provides functions for reading, processing, and saving EEG/MEG data using MNE, xarray, and pandas.
It supports reading raw or epoched data, event/response detection, reaction time trimming, epoch cropping,
metadata handling, and conversion to xarray Datasets for fitting hmp models. Additional utilities are provided
for saving/loading data and models, and exporting event probabilities.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hmp.io.hmp_data_format">
<span class="sig-prename descclassname"><span class="pre">hmp.io.</span></span><span class="sig-name descname"><span class="pre">hmp_data_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.io.hmp_data_format" title="Link to this definition"></a></dt>
<dd><p>Convert data to the expected xarray Dataset format.</p>
<p>This function reshapes a 3D or 4D matrix with dimensions
(participant) * trial * channel * sample into an xarray Dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – 4D or 3D matrix with dimensions (participant) * trial * channel * sample.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling frequency of the data.</p></li>
<li><p><strong>events</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Description for each epoch and participant that need to be stored (e.g. condition)</p></li>
<li><p><strong>offset</strong> (<em>float</em><em>, </em><em>default=0</em>) – Offset in seconds to apply to the data.</p></li>
<li><p><strong>participants</strong> (<em>list</em><em>, </em><em>optional</em>) – List of participant indices.</p></li>
<li><p><strong>epochs</strong> (<em>list</em><em>, </em><em>optional</em>) – List of epoch indices.</p></li>
<li><p><strong>channel</strong> (<em>list</em><em>, </em><em>optional</em>) – List of channel indices.</p></li>
<li><p><strong>metadata</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – Metadata associated with the epochs. Should be a pandas DataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An xarray Dataset containing the reshaped data, with appropriate dimensions and attributes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.io.load">
<span class="sig-prename descclassname"><span class="pre">hmp.io.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.io.load" title="Link to this definition"></a></dt>
<dd><p>Load an hmp model from a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The name of the file where the object will be saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.io.load_xr">
<span class="sig-prename descclassname"><span class="pre">hmp.io.</span></span><span class="sig-name descname"><span class="pre">load_xr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.io.load_xr" title="Link to this definition"></a></dt>
<dd><p>Load fit or data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.io.read_mne_data">
<span class="sig-prename descclassname"><span class="pre">hmp.io.</span></span><span class="sig-name descname"><span class="pre">read_mne_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pfiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resp_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subj_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events_provided</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rt_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_after_resp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_pass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_pass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eeg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upper_limit_rt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower_limit_rt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reject_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_rt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bids_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.io.read_mne_data" title="Link to this definition"></a></dt>
<dd><p>Read EEG/MEG data format (.fif or .bdf) using MNE’s integrated function.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Only EEG or MEG data are selected (other channel types are discarded).</p></li>
<li><p>All times are expressed in seconds.</p></li>
<li><p>If multiple files are provided in <code class="docutils literal notranslate"><span class="pre">pfiles</span></code>, each participant’s data is read and processed sequentially.</p></li>
<li><p>For non-epoched data: Reaction Times are only computed if the response trigger is in the epoching
window (determined by <code class="docutils literal notranslate"><span class="pre">tmin</span></code> and <code class="docutils literal notranslate"><span class="pre">tmax</span></code>).</p></li>
</ul>
<p>## Procedure:</p>
<p>If data is not already epoched:</p>
<blockquote>
<div><ul class="simple">
<li><p>The data is filtered using the specified <code class="docutils literal notranslate"><span class="pre">low_pass</span></code> and <code class="docutils literal notranslate"><span class="pre">high_pass</span></code> parameters.</p></li>
<li><p>If no events are provided, events are detected in the stimulus channel and only those with IDs
in <code class="docutils literal notranslate"><span class="pre">event_id</span></code> and <code class="docutils literal notranslate"><span class="pre">resp_id</span></code> are kept.</p></li>
<li><p>Downsampling is performed if <code class="docutils literal notranslate"><span class="pre">sfreq</span></code> is lower than the data’s sampling frequency.</p></li>
<li><p>Epochs are created based on stimulus onsets (<code class="docutils literal notranslate"><span class="pre">event_id</span></code>) and the <code class="docutils literal notranslate"><span class="pre">tmin</span></code>/<code class="docutils literal notranslate"><span class="pre">tmax</span></code> window.
Epochs with ‘BAD’ annotations are removed. Baseline correction is applied from
<code class="docutils literal notranslate"><span class="pre">tmin</span></code> to stimulus onset (time 0).</p></li>
</ul>
</div></blockquote>
<p>Then (or if data is already epoched):</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Reaction times (RT) are computed as the time difference between stimulus and response triggers.
If no response event occurs after a stimulus in the epoch window, or if
<code class="docutils literal notranslate"><span class="pre">RT</span> <span class="pre">&gt;</span> <span class="pre">upper_limit_rt</span></code> or <code class="docutils literal notranslate"><span class="pre">RT</span> <span class="pre">&lt;</span> <span class="pre">lower_limit_rt</span></code>, RT is set to 0.</p></li>
<li><p>All non-rejected epochs with positive RTs are cropped from stimulus onset to
<code class="docutils literal notranslate"><span class="pre">stimulus_onset</span> <span class="pre">+</span> <span class="pre">RT</span></code>.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pfiles</strong> (<em>str</em><em> or </em><em>list</em><em> of </em><em>str</em>) – Path(s) to EEG files to read. Can be a single file path or a list of file paths.</p></li>
<li><p><strong>event_id</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping condition names (keys) to event codes (values).</p></li>
<li><p><strong>resp_id</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping response names (keys) to event codes (values).</p></li>
<li><p><strong>data_format</strong> (<em>str</em><em>, </em><em>default=epochs</em>) – What MNE compatible data type, can be ‘epochs’ or ‘raw’.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em><em>, </em><em>optional</em>) – Desired sampling frequency for downsampling.</p></li>
<li><p><strong>subj_name</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – List of subject identifiers. If not provided, defaults to “S0”, “S1”, etc.</p></li>
<li><p><strong>metadata</strong> (<em>list</em><em> of </em><em>pandas.DataFrame</em><em>, </em><em>optional</em>) – List of metadata DataFrames corresponding to each participant.</p></li>
<li><p><strong>events_provided</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Array with 3 columns: [sample of the event, initial value of the channel, event code].
Used if automated event detection is not suitable.</p></li>
<li><p><strong>rt_col</strong> (<em>str</em><em>, </em><em>default=&quot;rt&quot;</em>) – Column name in metadata containing reaction times.</p></li>
<li><p><strong>rts</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Array of reaction times. Used if metadata is not provided.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to display MNE’s messages.</p></li>
<li><p><strong>tmin</strong> (<em>float</em><em>, </em><em>default=-0.2</em>) – Start time (in seconds) relative to stimulus onset for epoching.</p></li>
<li><p><strong>tmax</strong> (<em>float</em><em>, </em><em>default=5</em>) – End time (in seconds) relative to stimulus onset for epoching.</p></li>
<li><p><strong>offset_after_resp</strong> (<em>float</em><em>, </em><em>default=0</em>) – Additional time (in seconds) to include after the response onset.</p></li>
<li><p><strong>high_pass</strong> (<em>float</em><em>, </em><em>optional</em>) – High-pass filter cutoff frequency.</p></li>
<li><p><strong>low_pass</strong> (<em>float</em><em>, </em><em>optional</em>) – Low-pass filter cutoff frequency.</p></li>
<li><p><strong>pick_channels</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>default=&quot;eeg&quot;</em>) – Channels to retain. Use “eeg”/”meg” to keep only EEG/MEG channels or provide a list of channel names.</p></li>
<li><p><strong>baseline</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>None</em><em>, </em><em>0</em><em>)</em>) – Time range for baseline correction (start, end) in seconds.</p></li>
<li><p><strong>upper_limit_rt</strong> (<em>float</em><em>, </em><em>default=np.inf</em>) – Upper limit for reaction times. Longer RTs are discarded.</p></li>
<li><p><strong>lower_limit_rt</strong> (<em>float</em><em>, </em><em>default=0</em>) – Lower limit for reaction times. Shorter RTs are discarded.</p></li>
<li><p><strong>reject_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for rejecting epochs based on signal amplitude within the stimulus-response interval.</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>default=1</em>) – Scaling factor for reaction times (e.g., 1000 for milliseconds).</p></li>
<li><p><strong>reference</strong> (<em>str</em><em>, </em><em>optional</em>) – Reference to use for EEG data. If None, the existing reference is kept.</p></li>
<li><p><strong>ignore_rt</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to ignore reaction times and parse epochs up to <cite>tmax</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>epoch_data</strong> – An xarray Dataset containing the processed EEG/MEG data, events, channels, and participants.
Metadata and epoch indices are preserved. The chosen sampling frequency is stored as an attribute.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.io.read_raw_and_epoch">
<span class="sig-prename descclassname"><span class="pre">hmp.io.</span></span><span class="sig-name descname"><span class="pre">read_raw_and_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">participant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subj_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resp_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events_provided</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_pass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_pass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pick_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bids_parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.io.read_raw_and_epoch" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.io.save">
<span class="sig-prename descclassname"><span class="pre">hmp.io.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.io.save" title="Link to this definition"></a></dt>
<dd><p>Save an hmp model to a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object_to_save</strong> (<em>object</em>) – The Python object to save.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – The name of the file where the object will be saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.io.save_eventprobs_csv">
<span class="sig-prename descclassname"><span class="pre">hmp.io.</span></span><span class="sig-name descname"><span class="pre">save_eventprobs_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.io.save_eventprobs_csv" title="Link to this definition"></a></dt>
<dd><p>Save event probability estimates to a CSV file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimates</strong> (<em>xarray.DataArray</em><em> or </em><em>xarray.Dataset</em>) – The event probability estimates to save.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – The path to the CSV file where the estimates will be saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.io.save_xr">
<span class="sig-prename descclassname"><span class="pre">hmp.io.</span></span><span class="sig-name descname"><span class="pre">save_xr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.io.save_xr" title="Link to this definition"></a></dt>
<dd><p>Save fit.</p>
</dd></dl>

</section>
<section id="distributions-module">
<h2>Distributions module<a class="headerlink" href="#distributions-module" title="Link to this heading"></a></h2>
<p id="module-hmp.distributions">This module defines classes for several probability distributions (Gamma, Lognormal, Wald, Weibull).</p>
<dl class="py class">
<dt class="sig sig-object py" id="hmp.distributions.Gamma">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.distributions.</span></span><span class="sig-name descname"><span class="pre">Gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.distributions.Gamma" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Define a gamma distribution.</p>
<p>This class represents a gamma distribution with a specified shape parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>float</em><em>, </em><em>optional</em>) – The shape parameter of the gamma distribution (default is 2).</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.distributions.Gamma.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#hmp.distributions.Gamma.shape" title="Link to this definition"></a></dt>
<dd><p>The shape parameter of the gamma distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.distributions.Gamma.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><a class="headerlink" href="#hmp.distributions.Gamma.pdf" title="Link to this definition"></a></dt>
<dd><p>The probability density function from <cite>scipy.stats.gamma</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.distributions.Gamma.scale_to_mean">
<span class="sig-name descname"><span class="pre">scale_to_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hmp.distributions.Gamma.scale_to_mean" title="Link to this definition"></a></dt>
<dd><p>Compute the mean of the distribution given a scale parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.distributions.Gamma.mean_to_scale">
<span class="sig-name descname"><span class="pre">mean_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hmp.distributions.Gamma.mean_to_scale" title="Link to this definition"></a></dt>
<dd><p>Compute the scale parameter of the distribution given a mean.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">mean_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Compute the scale associated with a given mean and shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> (<em>float</em>) – The mean value of the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated scale parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">scale_to_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Compute the mean associated with a given scale and shape parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>float</em>) – The scale parameter of the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated mean value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hmp.distributions.Lognorm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.distributions.</span></span><span class="sig-name descname"><span class="pre">Lognorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.distributions.Lognorm" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Define a Lognormal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>float</em>) – The shape parameter of the lognormal distribution.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.distributions.Lognorm.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#hmp.distributions.Lognorm.shape" title="Link to this definition"></a></dt>
<dd><p>The shape parameter of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.distributions.Lognorm.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><a class="headerlink" href="#hmp.distributions.Lognorm.pdf" title="Link to this definition"></a></dt>
<dd><p>The probability density function from <cite>scipy.stats.lognorm</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.distributions.Lognorm.scale_to_mean">
<span class="sig-name descname"><span class="pre">scale_to_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hmp.distributions.Lognorm.scale_to_mean" title="Link to this definition"></a></dt>
<dd><p>Compute the mean of the distribution given a scale parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.distributions.Lognorm.mean_to_scale">
<span class="sig-name descname"><span class="pre">mean_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hmp.distributions.Lognorm.mean_to_scale" title="Link to this definition"></a></dt>
<dd><p>Compute the scale parameter of the distribution given a mean.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">mean_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Compute the scale associated with a given mean and shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> (<em>float</em>) – The mean value of the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated scale parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">scale_to_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Compute the mean associated with a given scale and shape parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>float</em>) – The scale parameter of the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated mean value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hmp.distributions.Wald">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.distributions.</span></span><span class="sig-name descname"><span class="pre">Wald</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.distributions.Wald" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Define a Wald distribution (aka inverse Gaussian).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>float</em>) – The shape parameter of the Wald distribution.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.distributions.Wald.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#hmp.distributions.Wald.shape" title="Link to this definition"></a></dt>
<dd><p>The shape parameter of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.distributions.Wald.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><a class="headerlink" href="#hmp.distributions.Wald.pdf" title="Link to this definition"></a></dt>
<dd><p>The probability density function from <cite>scipy.stats.invgauss</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.distributions.Wald.scale_to_mean">
<span class="sig-name descname"><span class="pre">scale_to_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hmp.distributions.Wald.scale_to_mean" title="Link to this definition"></a></dt>
<dd><p>Compute the mean of the distribution given a scale parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.distributions.Wald.mean_to_scale">
<span class="sig-name descname"><span class="pre">mean_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hmp.distributions.Wald.mean_to_scale" title="Link to this definition"></a></dt>
<dd><p>Compute the scale parameter of the distribution given a mean.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">mean_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Compute the scale associated with a given mean and shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> (<em>float</em>) – The mean value of the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated scale parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">scale_to_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Compute the mean associated with a given scale and shape parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>float</em>) – The scale parameter of the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated mean value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hmp.distributions.Weibull">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.distributions.</span></span><span class="sig-name descname"><span class="pre">Weibull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.distributions.Weibull" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Define a Weibull distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shape</strong> (<em>float</em>) – The shape parameter of the Wald distribution.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.distributions.Weibull.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#hmp.distributions.Weibull.shape" title="Link to this definition"></a></dt>
<dd><p>The shape parameter of the distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.distributions.Weibull.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><a class="headerlink" href="#hmp.distributions.Weibull.pdf" title="Link to this definition"></a></dt>
<dd><p>The probability density function from <cite>scipy.stats.weibull_min</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.distributions.Weibull.scale_to_mean">
<span class="sig-name descname"><span class="pre">scale_to_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hmp.distributions.Weibull.scale_to_mean" title="Link to this definition"></a></dt>
<dd><p>Compute the mean of the distribution given a scale parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.distributions.Weibull.mean_to_scale">
<span class="sig-name descname"><span class="pre">mean_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#hmp.distributions.Weibull.mean_to_scale" title="Link to this definition"></a></dt>
<dd><p>Compute the scale parameter of the distribution given a mean.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">mean_to_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Compute the scale associated with a given mean and shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mean</strong> (<em>float</em>) – The mean value of the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated scale parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">scale_to_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Compute the mean associated with a given scale and shape parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>float</em>) – The scale parameter of the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The calculated mean value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="patterns-module">
<h2>Patterns module<a class="headerlink" href="#patterns-module" title="Link to this heading"></a></h2>
<p id="module-hmp.patterns">This module provides classes for generating and representing templates for HMP event detection,
including a half-sine wave template (<cite>HalfSine</cite>) and an arbitrary waveform template (<cite>Arbitrary</cite>).</p>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>HalfSine</dt><dd><p>Generates a normalized half-sine wave template for use in signal processing or event detection.</p>
</dd>
<dt>Arbitrary</dt><dd><p>Allows the use of any arbitrary pattern as a template.</p>
</dd>
</dl>
<p>Both classes provide methods to create expected templates based on sampling frequency and other parameters,
and store relevant metadata such as template width and censoring location for model fitting procedures.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="hmp.patterns.Arbitrary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.patterns.</span></span><span class="sig-name descname"><span class="pre">Arbitrary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.patterns.Arbitrary" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents an arbitrary template.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.patterns.Arbitrary.sfreq">
<span class="sig-name descname"><span class="pre">sfreq</span></span><a class="headerlink" href="#hmp.patterns.Arbitrary.sfreq" title="Link to this definition"></a></dt>
<dd><p>Sampling frequency in Hz.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.patterns.Arbitrary.width_samples">
<span class="sig-name descname"><span class="pre">width_samples</span></span><a class="headerlink" href="#hmp.patterns.Arbitrary.width_samples" title="Link to this definition"></a></dt>
<dd><p>Number of samples in the template.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.patterns.Arbitrary.location">
<span class="sig-name descname"><span class="pre">location</span></span><a class="headerlink" href="#hmp.patterns.Arbitrary.location" title="Link to this definition"></a></dt>
<dd><p>How much samples should be censored in the EM() step of model fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.patterns.Arbitrary.template">
<span class="sig-name descname"><span class="pre">template</span></span><a class="headerlink" href="#hmp.patterns.Arbitrary.template" title="Link to this definition"></a></dt>
<dd><p>The arbitrary template.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.patterns.Arbitrary.create_expected">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_expected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.patterns.Arbitrary.create_expected" title="Link to this definition"></a></dt>
<dd><p>Create an Arbitrary instance with the expected parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling frequency in Hz.</p></li>
<li><p><strong>template</strong> (<em>np.ndarray</em>) – The arbitrary waveform template.</p></li>
<li><p><strong>location</strong> (<em>float</em><em>, </em><em>optional</em>) – How much samples should be censored in the EM() step of model fitting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the Arbitrary class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hmp.patterns.Arbitrary" title="hmp.patterns.Arbitrary">Arbitrary</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">location</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">sfreq</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">template</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">width_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hmp.patterns.HalfSine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.patterns.</span></span><span class="sig-name descname"><span class="pre">HalfSine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.patterns.HalfSine" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a half-sine wave template.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.patterns.HalfSine.sfreq">
<span class="sig-name descname"><span class="pre">sfreq</span></span><a class="headerlink" href="#hmp.patterns.HalfSine.sfreq" title="Link to this definition"></a></dt>
<dd><p>Sampling frequency in Hz.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.patterns.HalfSine.width_samples">
<span class="sig-name descname"><span class="pre">width_samples</span></span><a class="headerlink" href="#hmp.patterns.HalfSine.width_samples" title="Link to this definition"></a></dt>
<dd><p>Number of samples in the half-sine wave.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.patterns.HalfSine.location">
<span class="sig-name descname"><span class="pre">location</span></span><a class="headerlink" href="#hmp.patterns.HalfSine.location" title="Link to this definition"></a></dt>
<dd><p>How much samples should be censored in the EM() step of model fitting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.patterns.HalfSine.template">
<span class="sig-name descname"><span class="pre">template</span></span><a class="headerlink" href="#hmp.patterns.HalfSine.template" title="Link to this definition"></a></dt>
<dd><p>The half-sine wave template.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.patterns.HalfSine.create_expected">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_expected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.patterns.HalfSine.create_expected" title="Link to this definition"></a></dt>
<dd><p>Create a HalfSine instance with the expected parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling frequency in Hz.</p></li>
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – Width of the half-sine wave in milliseconds, by default 50.</p></li>
<li><p><strong>location</strong> (<em>float</em><em>, </em><em>optional</em>) – How much samples should be censored in the EM() step of model fitting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the HalfSine class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hmp.patterns.HalfSine" title="hmp.patterns.HalfSine">HalfSine</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">location</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">sfreq</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">template</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">width_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-hmp.preprocessing">
<span id="preprocessing-module"></span><h2>Preprocessing module<a class="headerlink" href="#module-hmp.preprocessing" title="Link to this heading"></a></h2>
<p>This module provides tools for dimensionality reduction and normalization prior to HMP analysis.</p>
<dl class="simple">
<dt>Features:</dt><dd><ul class="simple">
<li><p>Standardization of participant variances</p></li>
<li><p>Spatial PCA and MCCA transformations</p></li>
<li><p>Flexible z-scoring (across all data, by participant, or by trial)</p></li>
<li><p>Optional bandpass filtering</p></li>
</ul>
</dd>
<dt>Classes:</dt><dd><ul class="simple">
<li><p>ApplyZScore: Specifies how and whether to apply z-scoring (options: all data, by participant, by trial, or not at all).</p></li>
<li><p>AnalysisMethod: Specifies which method to reduce channel space (PCA, MCCA, or none).</p></li>
<li><p>Preprocessing: Main class for preprocessing EEG data.</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="hmp.preprocessing.AnalysisMethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.preprocessing.</span></span><span class="sig-name descname"><span class="pre">AnalysisMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.preprocessing.AnalysisMethod" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.preprocessing.AnalysisMethod.MCCA">
<span class="sig-name descname"><span class="pre">MCCA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mcca'</span></em><a class="headerlink" href="#hmp.preprocessing.AnalysisMethod.MCCA" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.preprocessing.AnalysisMethod.NO_ANALYSIS">
<span class="sig-name descname"><span class="pre">NO_ANALYSIS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'no_analysis'</span></em><a class="headerlink" href="#hmp.preprocessing.AnalysisMethod.NO_ANALYSIS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.preprocessing.AnalysisMethod.PCA">
<span class="sig-name descname"><span class="pre">PCA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'pca'</span></em><a class="headerlink" href="#hmp.preprocessing.AnalysisMethod.PCA" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.preprocessing.AnalysisMethod.parse">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.preprocessing.AnalysisMethod.parse" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hmp.preprocessing.ApplyZScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.preprocessing.</span></span><span class="sig-name descname"><span class="pre">ApplyZScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.preprocessing.ApplyZScore" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.preprocessing.ApplyZScore.ALL">
<span class="sig-name descname"><span class="pre">ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'all'</span></em><a class="headerlink" href="#hmp.preprocessing.ApplyZScore.ALL" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.preprocessing.ApplyZScore.DONT_APPLY">
<span class="sig-name descname"><span class="pre">DONT_APPLY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'dont_apply'</span></em><a class="headerlink" href="#hmp.preprocessing.ApplyZScore.DONT_APPLY" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.preprocessing.ApplyZScore.PARTICIPANT">
<span class="sig-name descname"><span class="pre">PARTICIPANT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'participant'</span></em><a class="headerlink" href="#hmp.preprocessing.ApplyZScore.PARTICIPANT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.preprocessing.ApplyZScore.TRIAL">
<span class="sig-name descname"><span class="pre">TRIAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'trial'</span></em><a class="headerlink" href="#hmp.preprocessing.ApplyZScore.TRIAL" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.preprocessing.ApplyZScore.parse">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.preprocessing.ApplyZScore.parse" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="hmp.preprocessing.Preprocessing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.preprocessing.</span></span><span class="sig-name descname"><span class="pre">Preprocessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participants_variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'participant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_standard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">averaged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_zscore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ApplyZScore.TRIAL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zscore_across_pcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">AnalysisMethod.PCA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ppcas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandfilter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcca_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.preprocessing.Preprocessing" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Preprocess EEG epoched data (in xarray format) for HMP analysis.</p>
<p>This function performs several preprocessing steps on EEG data:</p>
<ol class="arabic simple">
<li><p>Optionally standardizes individual variances between participants (if <code class="docutils literal notranslate"><span class="pre">apply_standard=True</span></code>).</p></li>
<li><p>Applies a spatial PCA or MCCA on the data, depending on the selected method.</p></li>
<li><p>Stacks the data from the format [n_participants * n_epochs * n_samples * n_channels]
to [sample * channel].</p></li>
<li><p>Optionally applies z-scoring on the data, either across all data, by participant,
or by trial, depending on the <code class="docutils literal notranslate"><span class="pre">apply_zscore</span></code> parameter.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch_data</strong> (<em>xr.DataArray</em>) – Input data with dimensions [n_participants * n_epochs * n_samples * n_channels].</p></li>
<li><p><strong>participants_variable</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the dimension for participant IDs. Default is ‘participant’.</p></li>
<li><p><strong>apply_standard</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to standardize variance between participants. Recommended when there are
few participants (e.g., &lt; 10). Default is False.</p></li>
<li><p><strong>averaged</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply PCA/MCCA on the averaged ERP (True) or single-trial ERP (False).
Only applicable for the MCCA method when cov=False. Default is False.</p></li>
<li><p><strong>apply_zscore</strong> (<em>Union</em><em>[</em><em>bool</em><em>, </em><em>str</em><em>, </em><a class="reference internal" href="#hmp.preprocessing.ApplyZScore" title="hmp.preprocessing.ApplyZScore"><em>ApplyZScore</em></a><em>]</em><em>, </em><em>optional</em>) – Specifies whether to apply z-scoring and on what data. Options are:
- ‘all’: Z-score across all data.
- ‘participant’: Z-score by participant.
- ‘trial’: Z-score by trial.
- None or ‘dont_apply’: No z-scoring.
If set to True, defaults to ‘trial’ for backward compatibility. Default is ApplyZScore.TRIAL.</p></li>
<li><p><strong>method</strong> (<em>Union</em><em>[</em><em>bool</em><em>, </em><em>str</em><em>, </em><a class="reference internal" href="#hmp.preprocessing.AnalysisMethod" title="hmp.preprocessing.AnalysisMethod"><em>AnalysisMethod</em></a><em>]</em><em>, </em><em>optional</em>) – Analysis method to apply. Options are:
- ‘pca’: Apply PCA.
- ‘mcca’: Apply MCCA.
- ‘no_analysis’: Skip analysis. Default is AnalysisMethod.PCA.</p></li>
<li><p><strong>cov</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply PCA/MCCA to the variance-covariance matrix (True) or the epoched data (False).
Only applicable for the MCCA method. Default is True.</p></li>
<li><p><strong>n_comp</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of components to retain in the PC space. If None, a scree plot is displayed,
and the user is prompted to specify the number of components. Default is None.</p></li>
<li><p><strong>n_ppcas</strong> (<em>int</em><em>, </em><em>optional</em>) – For the MCCA method, controls the number of components retained for by-participant PCAs. Default is None.</p></li>
<li><p><strong>weights</strong> (<em>Optional</em><em>[</em><em>xr.DataArray</em><em>]</em><em>, </em><em>optional</em>) – Precomputed linear combinations of channels. Default is None.</p></li>
<li><p><strong>bandfilter</strong> (<em>Optional</em><em>[</em><em>tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Frequency range for bandpass filtering (lfreq, hfreq). If None, no filtering is applied.
Filtering at this step is suboptimal; it is recommended to filter before epoching. Default is None.</p></li>
<li><p><strong>mcca_reg</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularization parameter for the MCCA computation. Default is 0.</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to copy the data before transforming. If False, the data is modified in place. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Preprocessed data with dimensions [n_samples * n_comp], expressed in the PC space, ready for HMP analysis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="hmp.preprocessing.Preprocessing.stack_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stack_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.preprocessing.Preprocessing.stack_data" title="Link to this definition"></a></dt>
<dd><p>Stack the data.</p>
<p>Going from format [n_participant * n_epochs <a href="#id16"><span class="problematic" id="id17">*</span></a><a href="#id28"><span class="problematic" id="id29">n_</span></a> n_samples * n_channels] to
[sample * channel] with sample indexes starts and ends to delimitate the epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xarray</em>) – xarray with dimensions [n_participant * n_epochs * n_samples * n_channels]</p></li>
<li><p><strong>subjects_variable</strong> (<em>str</em>) – name of the dimension for subjects ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – xarray dataset [sample * channel]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.preprocessing.Preprocessing.zscore_xarray">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zscore_xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.preprocessing.Preprocessing.zscore_xarray" title="Link to this definition"></a></dt>
<dd><p>Zscore of the data in an xarray, avoiding any nans.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.preprocessing.user_input_n_comp">
<span class="sig-prename descclassname"><span class="pre">hmp.preprocessing.</span></span><span class="sig-name descname"><span class="pre">user_input_n_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.preprocessing.user_input_n_comp" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-hmp.trialdata">
<span id="trialdata-module"></span><h2>TrialData module<a class="headerlink" href="#module-hmp.trialdata" title="Link to this heading"></a></h2>
<p>Builds the data to be used in HMP model estimation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.trialdata.</span></span><span class="sig-name descname"><span class="pre">TrialData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">named_durations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ends</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_corr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.trialdata.TrialData" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class building trial data and its associated properties to use in the estimations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.named_durations">
<span class="sig-name descname"><span class="pre">named_durations</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.named_durations" title="Link to this definition"></a></dt>
<dd><p>Durations of each trial with names corresponding to trial indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.coords">
<span class="sig-name descname"><span class="pre">coords</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.coords" title="Link to this definition"></a></dt>
<dd><p>Coordinates of the trial data (metadata to keep).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.starts">
<span class="sig-name descname"><span class="pre">starts</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.starts" title="Link to this definition"></a></dt>
<dd><p>Array of start indices for each trial (usually stimulus onsets position in samples).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.ends">
<span class="sig-name descname"><span class="pre">ends</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.ends" title="Link to this definition"></a></dt>
<dd><p>Array of end indices for each trial (usually response onsets position in samples)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.n_trials">
<span class="sig-name descname"><span class="pre">n_trials</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.n_trials" title="Link to this definition"></a></dt>
<dd><p>Total number of trials.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.n_samples">
<span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.n_samples" title="Link to this definition"></a></dt>
<dd><p>Total number of samples across all trials.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.sfreq">
<span class="sig-name descname"><span class="pre">sfreq</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.sfreq" title="Link to this definition"></a></dt>
<dd><p>Sampling frequency of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.offset">
<span class="sig-name descname"><span class="pre">offset</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.offset" title="Link to this definition"></a></dt>
<dd><p>Offset applied to the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.cross_corr">
<span class="sig-name descname"><span class="pre">cross_corr</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.cross_corr" title="Link to this definition"></a></dt>
<dd><p>Cross-correlation values between the data and a given pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.trial_coords">
<span class="sig-name descname"><span class="pre">trial_coords</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.trial_coords" title="Link to this definition"></a></dt>
<dd><p>Coordinates specific to each trial.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">coords</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></em><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">cross_corr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.durations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">durations</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.durations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">ends</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.from_preprocessed">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_preprocessed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.trialdata.TrialData.from_preprocessed" title="Link to this definition"></a></dt>
<dd><p>Create a TrialData instance from preprocessed data and a given pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed</strong> (<a class="reference internal" href="#hmp.preprocessing.Preprocessing" title="hmp.preprocessing.Preprocessing"><em>Preprocessing</em></a><em> or </em><em>xr.DataArray</em>) – The preprocessed object or xarray DataArray containing the preprocessed data.</p></li>
<li><p><strong>pattern</strong> (<em>np.ndarray</em>) – The pattern to use for cross-correlation computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of TrialData with computed durations, cross-correlation, and metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#hmp.trialdata.TrialData" title="hmp.trialdata.TrialData">TrialData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="hmp.trialdata.TrialData.n_dims">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_dims</span></span><a class="headerlink" href="#hmp.trialdata.TrialData.n_dims" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">n_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">n_trials</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">named_durations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray</span></code></em><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">offset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">sfreq</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">starts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></em><a class="headerlink" href="#id26" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">trial_coords</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></em><a class="headerlink" href="#id27" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.trialdata.cross_correlation">
<span class="sig-prename descclassname"><span class="pre">hmp.trialdata.</span></span><span class="sig-name descname"><span class="pre">cross_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ends</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.trialdata.cross_correlation" title="Link to this definition"></a></dt>
<dd><p>Compute the cross-correlation between the data and a given pattern.</p>
<p>This function calculates the correlation of each sample and the next
x samples (depending on sampling frequency and event size) with a given pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – 2D ndarray with shape (n_samples, n_components).</p></li>
<li><p><strong>n_trials</strong> (<em>int</em>) – Number of trials in the data.</p></li>
<li><p><strong>n_dims</strong> (<em>int</em>) – Number of dimensions (components) in the data.</p></li>
<li><p><strong>starts</strong> (<em>np.ndarray</em>) – Array of start indices for each trial.</p></li>
<li><p><strong>ends</strong> (<em>np.ndarray</em>) – Array of end indices for each trial.</p></li>
<li><p><strong>pattern</strong> (<em>np.ndarray</em>) – 1D array representing the pattern to correlate with.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D ndarray with shape (n_samples, n_components) where each cell contains
the correlation value with the given pattern.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="visualization-module">
<h2>Visualization module<a class="headerlink" href="#visualization-module" title="Link to this heading"></a></h2>
<p id="module-hmp.visu">Module containing functions to visualize the results of the HMP model.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hmp.visu.erp_data">
<span class="sig-prename descclassname"><span class="pre">hmp.visu.</span></span><span class="sig-name descname"><span class="pre">erp_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoched_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.visu.erp_data" title="Link to this definition"></a></dt>
<dd><p>Create a data array compatible with the plot ERP function.</p>
<p>Optionnally this function can resample the epochs to fit some provided times (e.g. onset of
the events).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoched_data</strong> (<em>xr.Dataset</em>) – Epoched physiological data with dims ‘participant’X ‘epochs’ X ‘channels’X ‘sample’</p></li>
<li><p><strong>times</strong> (<em>xr.Dataset</em>) – Times between wich to extract or resample the data with dims ‘trial’ X
‘event’</p></li>
<li><p><strong>channel</strong> (<em>str</em>) – For which channel to extract the data</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – How many sample to resample on if any</p></li>
<li><p><strong>pad</strong> (<em>int</em>) – padding added to the beginning and the end of the signal</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – array containing the extracted times for each epoch and stage with format epochs X events X
sample.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nd.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.visu.plot_components_sensor">
<span class="sig-prename descclassname"><span class="pre">hmp.visu.</span></span><span class="sig-name descname"><span class="pre">plot_components_sensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Spectral_r'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.visu.plot_components_sensor" title="Link to this definition"></a></dt>
<dd><p>Visualize the topomap of the HMP principal components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>xr.DataArray</em>) – DataArray containing the weights of the principal components.
Should have a ‘component’ dimension.</p></li>
<li><p><strong>positions</strong> (<em>np.ndarray</em><em> | </em><em>mne.Info</em>) – Array of x and y positions to plot channels on a head model, or an MNE Info object
containing channel location information.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap to use for the topomap, by default “Spectral_r”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.visu.plot_erp">
<span class="sig-prename descclassname"><span class="pre">hmp.visu.</span></span><span class="sig-name descname"><span class="pre">plot_erp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minmax_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.visu.plot_erp" title="Link to this definition"></a></dt>
<dd><p>Plot the ERP based on the times extracted by HMP.</p>
<p>Either around an event or just stimulus and response and the data extracted from <code class="docutils literal notranslate"><span class="pre">`erp_data`</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>times</strong> (<em>xr.Dataset</em>) – Times between wich to extract or resample the data with dims</p></li>
<li><p><strong>data</strong> (<em>nd.array</em>) – numpy array from the erp_data functino</p></li>
<li><p><strong>color</strong> (<em>str</em>) – color for the lines</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot</em>) – ax on which to draw</p></li>
<li><p><strong>minmax_lines</strong> (<em>tuple</em>) – Min and max arguments for the vertical lines on the plot</p></li>
<li><p><strong>upsample</strong> (<em>float</em>) – Upsampling factor for the times</p></li>
<li><p><strong>bootstrap</strong> (<em>int</em>) – how many bootstrap draw to perform</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.visu.plot_latencies">
<span class="sig-prename descclassname"><span class="pre">hmp.visu.</span></span><span class="sig-name descname"><span class="pre">plot_latencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['cornflowerblue',</span> <span class="pre">'indianred',</span> <span class="pre">'orange',</span> <span class="pre">'darkblue',</span> <span class="pre">'darkgreen',</span> <span class="pre">'gold']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.visu.plot_latencies" title="Link to this definition"></a></dt>
<dd><p>Plot the average of stage latencies with choosen errors bars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimates</strong> (<em>hmp results object</em>) – hmp results object</p></li>
<li><p><strong>event_width</strong> (<em>float</em>) – <p>Display size of the event in time unit given sampling frequency.</p>
<p>If drawing a fitted object using hmp you can provide the event_width_sample of
fitted hmp (e.g. init.event_width_sample)</p>
</p></li>
<li><p><strong>labels</strong> (<em>tuples</em><em> | </em><em>list</em>) – labels to draw on the y axis</p></li>
<li><p><strong>colors</strong> (<em>ndarray</em>) – array of colors for the different stages</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em> | </em><em>tuple</em><em> | </em><em>ndarray</em>) – Length and heigth of the matplotlib plot</p></li>
<li><p><strong>errs</strong> (<em>str</em>) – Whether to display no error bars (None), standard deviation (‘std’),
or standard error (‘se’)</p></li>
<li><p><strong>times_to_display</strong> (<em>ndarray</em>) – Times to display (e.g. Reaction time or any other relevant time) in the time unit of the
fitted data</p></li>
<li><p><strong>max_time</strong> (<em>float</em>) – limit of the x (time) axe</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – bar or point</p></li>
<li><p><strong>as_time</strong> (<em>bool</em>) – if true, plot time (ms) instead of sample.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.visu.plot_loocv">
<span class="sig-prename descclassname"><span class="pre">hmp.visu.</span></span><span class="sig-name descname"><span class="pre">plot_loocv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loocv_estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'t-test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.visu.plot_loocv" title="Link to this definition"></a></dt>
<dd><p>Plot the LOOCV results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loocv_estimates</strong> (<em>ndarray</em><em> or </em><em>xarra.DataArray</em>) – results from a call to hmp.utils.loocv()</p></li>
<li><p><strong>pvals</strong> (<em>bool</em>) – Whether to display the pvalue with the associated test</p></li>
<li><p><strong>test</strong> (<em>str</em>) – which statistical test to compute for the difference in LOOCV-likelihood (one sample t-test
or sign test)</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em> | </em><em>tuple</em><em> | </em><em>ndarray</em>) – Length and heigth of the matplotlib plot</p></li>
<li><p><strong>indiv</strong> (<em>bool</em>) – Whether to plot individual lines</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.ax</em>) – Matplotlib object on which to draw the plot, can be useful if you want to control specific
aspects of the plots outside of this function</p></li>
<li><p><strong>mean</strong> (<em>bool</em>) – Whether to plot the mean</p></li>
<li><p><strong>additional_points</strong> – Additional likelihood points to be plotted. Should be provided as a list of tuples
containing the x coordinate and loocv estimates with a single event, e.g. [(5,estimates)].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – if ax was specified otherwise returns the plot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.visu.plot_topo_timecourse">
<span class="sig-prename descclassname"><span class="pre">hmp.visu.</span></span><span class="sig-name descname"><span class="pre">plot_topo_timecourse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times_to_display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Spectral_r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab:orange'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topo_size_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combined</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.visu.plot_topo_timecourse" title="Link to this definition"></a></dt>
<dd><p>Plot the event topographies at the average time of the onset of the next stage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch_data</strong> (<em>xr.DataArray</em>) – The original EEG data in HMP format.</p></li>
<li><p><strong>estimates</strong> (<em>xr.DataArray</em>) – The result from a fitted HMP model.</p></li>
<li><p><strong>channel_position</strong> (<em>np.ndarray</em>) – Either a 2D array with dimensions (channel, [x, y]) storing channel
locations in meters or an MNE info object containing digit points for channel locations.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> | </em><em>list</em><em> | </em><em>np.ndarray</em><em>, </em><em>optional</em>) – Length and height of the matplotlib plot.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – DPI of the matplotlib plot.</p></li>
<li><p><strong>magnify</strong> (<em>float</em><em>, </em><em>optional</em>) – How much the events should be enlarged. Useful to zoom on topographies.
Providing any value other than 1 will change the displayed size of the event.</p></li>
<li><p><strong>times_to_display</strong> (<em>str</em><em> | </em><em>np.ndarray</em><em>, </em><em>optional</em>) – Times to display (e.g., reaction time or any other relevant time)
in the time unit of the fitted data. If ‘all’, plots the times of all events.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap of matplotlib, used to change the colors on topographies</p></li>
<li><p><strong>ylabels</strong> (<em>dict</em><em> | </em><em>list</em><em>, </em><em>optional</em>) – Dictionary with {label_name: label_values}, e.g., {‘Condition’: [‘Speed’, ‘Accuracy’]}.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label of the x-axis. Default is None, which gives “Time (sample)”
or “Time (ms)” if <cite>as_time</cite> is True.</p></li>
<li><p><strong>max_time</strong> (<em>float</em><em>, </em><em>optional</em>) – Limit of the x (time) axis.</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum value for the colormap. If not explicitly set, uses the minimum across all topographies.</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum value for the colormap. If not explicitly set, uses the maximum across all topographies.</p></li>
<li><p><strong>title</strong> (<em>str</em><em> | </em><em>bool</em><em>, </em><em>optional</em>) – Title of the plot. If False, no title is displayed.</p></li>
<li><p><strong>ax</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Matplotlib Axes object on which to draw the plot. Useful for controlling specific aspects
of the plots outside of this function.</p></li>
<li><p><strong>sensors</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the sensors on the topographies.</p></li>
<li><p><strong>contours</strong> (<em>int</em><em> | </em><em>np.ndarray</em><em>, </em><em>optional</em>) – The number of contour lines to draw.</p></li>
<li><p><strong>event_lines</strong> (<em>str</em><em> | </em><em>bool</em><em>, </em><em>optional</em>) – Whether to plot lines and shading to indicate the moment of the event.
If True, uses “tab:orange”. If set as a color, uses the specified color.</p></li>
<li><p><strong>colorbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether a colorbar is plotted.</p></li>
<li><p><strong>topo_size_scaling</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to scale the size of the topographies with the event size. If True,
the size of topographies depends on the total plotted time interval. If False,
it is only dependent on <cite>magnify</cite>.</p></li>
<li><p><strong>as_time</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plot time in milliseconds instead of samples. Ignored if times are provided as an array.</p></li>
<li><p><strong>linecolors</strong> (<em>str</em><em>, </em><em>optional</em>) – Color of the lines in the plot.</p></li>
<li><p><strong>estimate_method</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘max’ or ‘mean’. Either take the max probability of each event on each trial,
or the weighted average.</p></li>
<li><p><strong>combined</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to combine levels by averaging across them (True) or plot each level (False, default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The matplotlib Axes object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.Axes</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-hmp.utils">
<span id="utils-module"></span><h2>Utils module<a class="headerlink" href="#module-hmp.utils" title="Link to this heading"></a></h2>
<p>Functions to transform the input data and the estimates.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.centered_activity">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">centered_activity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_after_event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_before_event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.centered_activity" title="Link to this definition"></a></dt>
<dd><p>Parse the single trial signal of channel in a given number of sample around one event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xr.Dataset</em>) – HMP data (untransformed but with trial and participant stacked)</p></li>
<li><p><strong>times</strong> (<em>xr.DataArray</em>) – Onset times as computed using onset_times()</p></li>
<li><p><strong>channel</strong> (<em>list</em>) – channel to pick for the parsing of the signal, must be a list even if only one</p></li>
<li><p><strong>event</strong> (<em>int</em>) – Which event is used to parse the signal</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – How many sample to record after the event (default = maximum duration between event and
the consecutive event)</p></li>
<li><p><strong>cut_after_event</strong> (<em>int</em>) – Which event after <code class="docutils literal notranslate"><span class="pre">`event`</span></code> to cut sample off, if 1 (Default) cut at the next event</p></li>
<li><p><strong>baseline</strong> (<em>int</em>) – How much sample should be kept before the event</p></li>
<li><p><strong>cut_before_event</strong> (<em>int</em>) – At which previous event to cut sample from, <code class="docutils literal notranslate"><span class="pre">`baseline`</span></code> if 0 (Default), no effect if
baseline = 0</p></li>
<li><p><strong>event_width</strong> (<em>int</em>) – Duration of the fitted events, used when cut_before_event is True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>centered_data</strong> – Xarray dataset with electrode value (data) and trial event time (time) and with
trial * sample dimension</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.condition_selection">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">condition_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'event'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.condition_selection" title="Link to this definition"></a></dt>
<dd><p>Select a subset from preprocessed_data.</p>
<p>The function selects epochs for which ‘condition_string’ is in ‘variable’ based on ‘method’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_data</strong> (<em>xr.Dataset</em>) – transformed EEG data for hmp, from utils.transform_data</p></li>
<li><p><strong>condition_string</strong> (<em>str</em><em> | </em><em>num</em>) – condition indicator for selection</p></li>
<li><p><strong>variable</strong> (<em>str</em>) – variable present in preprocessed_data that is used for condition selection</p></li>
<li><p><strong>method</strong> (<em>str</em>) – ‘equal’ selects equal trial, ‘contains’ selects trial in which conditions_string
appears in variable</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Subset of preprocessed_data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.condition_selection_epoch">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">condition_selection_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'event'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.condition_selection_epoch" title="Link to this definition"></a></dt>
<dd><p>Select a subset from epoch_data.</p>
<p>The function selects epochs for which ‘condition_string’ is in ‘variable’ based on ‘method’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch_data</strong> (<em>xr.Dataset</em>) – transformed EEG data for hmp, e.g. from utils.read_mne_data()</p></li>
<li><p><strong>condition_string</strong> (<em>str</em><em> | </em><em>num</em>) – condition indicator for selection</p></li>
<li><p><strong>variable</strong> (<em>str</em>) – variable present in preprocessed_data that is used for condition selection</p></li>
<li><p><strong>method</strong> (<em>str</em>) – ‘equal’ selects equal trial, ‘contains’ selects trial in which conditions_string
appears in variable</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Subset of preprocessed_data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.event_channels">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">event_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimated</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.event_channels" title="Link to this definition"></a></dt>
<dd><p>Compute topographies for each trial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch_data</strong> (<em>xr.Dataset</em>) – Epoched data</p></li>
<li><p><strong>estimated</strong> (<em>xr.Dataset</em>) – estimated model parameters and event probabilities</p></li>
<li><p><strong>mean</strong> (<em>bool</em>) – if True mean will be computed instead of single-trial channel activities</p></li>
<li><p><strong>peak</strong> (<em>bool</em>) – if true, return topography at peak of the event. If false, return topographies weighted
by a normalized template.</p></li>
<li><p><strong>estimate_method</strong> (<em>string</em>) – ‘max’ or ‘mean’, either take the max probability of each event on each trial, or the
weighted average.</p></li>
<li><p><strong>template</strong> (<em>int</em>) – Length of the pattern in sample (e.g. 5 for a pattern of 50 ms with a 100Hz sampling
frequency)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>event_values: xr.DataArray</dt><dd><p>array containing the values of each electrode at the most likely transition time
contains nans for missing events</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.event_times">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">event_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_rt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errorbars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_stim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.event_times" title="Link to this definition"></a></dt>
<dd><p>Compute the likeliest peak times for each event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimates</strong> (<em>xr.Dataset</em>) – Estimated instance of an HMP model</p></li>
<li><p><strong>duration</strong> (<em>bool</em>) – Whether to compute peak location (False) or inter-peak duration (True)</p></li>
<li><p><strong>mean</strong> (<em>bool</em>) – Whether to compute the mean (True) or return the single trial estimates
Note that mean and errorbars cannot both be true.</p></li>
<li><p><strong>add_rt</strong> (<em>bool</em>) – whether to append the last stage up to the RT</p></li>
<li><p><strong>as_time</strong> (<em>bool</em>) – if true, return time (ms) instead of sample</p></li>
<li><p><strong>errorbars</strong> (<em>str</em>) – calculate 95% confidence interval (‘ci’), standard deviation (‘std’),
standard error (‘se’) on the times or durations, or None.
Note that mean and errorbars cannot both be true.</p></li>
<li><p><strong>estimate_method</strong> (<em>string</em>) – ‘max’ or ‘mean’, either take the max probability of each event on each trial, or the
weighted average.</p></li>
<li><p><strong>add_stim</strong> (<em>bool</em>) – Adding stimulus as the first event (True) or let the first estimated HMP event be the
first one (False, default)</p></li>
<li><p><strong>remove_offset</strong> (<em>bool</em>) – Whether to remove the eventual offset added to the reaction time</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>times</strong> – Transition event peak or stage duration with trial*event dimensions or
only event dimension if mean = True contains nans for missing stages.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.participant_selection">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">participant_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.participant_selection" title="Link to this definition"></a></dt>
<dd><p>Select a participant from preprocessed_data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_data</strong> (<em>xr.Dataset</em>) – transformed EEG data for hmp, from utils.transform_data</p></li>
<li><p><strong>participant</strong> (<em>str</em><em> | </em><em>num</em>) – Name of the participant</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – Subset of preprocessed_data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.stack_data">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">stack_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.stack_data" title="Link to this definition"></a></dt>
<dd><p>Stack the data.</p>
<p>Going from format [participant * epochs * sample * channel] to
[sample * channel] with sample indexes starts and ends to delimitate the epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xarray</em>) – unstacked xarray data from transform_data() or anyother source yielding an xarray with
dimensions [participant * epochs * sample * channel]</p></li>
<li><p><strong>subjects_variable</strong> (<em>str</em>) – name of the dimension for subjects ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – xarray dataset [sample * channel]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.transform_data">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">transform_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participants_variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'participant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_standard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">averaged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_zscore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trial'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zscore_across_pcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pca'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ppcas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandfilter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcca_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.transform_data" title="Link to this definition"></a></dt>
<dd><p>Adapt EEG epoched data (in xarray format) to the expected data format for hmp.</p>
<p>First this code can apply standardization of individual variances (if apply_standard=True).
Second, a spatial PCA on the average variance-covariance matrix is performed (if method=’pca’,
more methods in development).
Third,stacks the data going from format [participant * epochs * sample * channel] to
[sample * channel].
Last, performs z-scoring on each epoch and for each principal component (PC), or for each
participant and PC, or across all data for each PC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xarray</em>) – unstacked xarray data from transform_data() or anyother source yielding an xarray with
dimensions [participant * epochs * sample * channel]</p></li>
<li><p><strong>participants_variable</strong> (<em>str</em>) – name of the dimension for participants ID</p></li>
<li><p><strong>apply_standard</strong> (<em>bool</em>) – Whether to apply standardization of variance between participants, recommended when they
are few of them (e.g. &lt; 10)</p></li>
<li><p><strong>averaged</strong> (<em>bool</em>) – Applying the pca on the averaged ERP (True) or single trial ERP (False, default).
No effect if cov = True</p></li>
<li><p><strong>apply_zscore</strong> (<em>str</em>) – Whether to apply z-scoring and on what data, either None, ‘all’, ‘participant’, ‘trial’,
for zscoring across all data, by participant, or by trial, respectively. If set to true,
evaluates to ‘trial’ for backward compatibility.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Method to apply, ‘pca’ or ‘mcca’</p></li>
<li><p><strong>cov</strong> (<em>bool</em>) – Wether to apply the pca/mcca to the variance covariance (True, default) or the epoched data</p></li>
<li><p><strong>n_comp</strong> (<em>int</em>) – How many components to select from the PC space, if None plots the scree plot and a prompt
requires user to specify how many PCs should be retained</p></li>
<li><p><strong>n_ppcas</strong> (<em>int</em>) – If method = ‘mcca’, controls the number of components retained for the by-participant PCAs</p></li>
<li><p><strong>pca_weigths</strong> (<em>xarray</em>) – Weights of a PCA to apply to the data (e.g. in the resample function)</p></li>
<li><p><strong>bandfilter</strong> (<em>None</em><em> | </em><em>(</em><em>lfreq</em><em>, </em><em>hfreq</em><em>)</em>) – If none, no filtering is appliedn. If tuple, data is filtered between lfreq-hfreq.
NOTE: filtering at this step is suboptimal, filter before epoching if at all possible, see
also <a class="reference external" href="https://mne.tools/stable/auto_tutorials/preprocessing/30_filtering_resampling.html">https://mne.tools/stable/auto_tutorials/preprocessing/30_filtering_resampling.html</a></p></li>
<li><p><strong>mcca_reg</strong> (<em>float</em>) – regularization used for the mcca computation (see mcca.py)</p></li>
<li><p><strong>copy</strong> (<em>bool</em>) – Whether to copy the data before transforming</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – xarray dataset [n_samples * n_comp] data expressed in the PC space, ready for HMP fit</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.utils.zscore_xarray">
<span class="sig-prename descclassname"><span class="pre">hmp.utils.</span></span><span class="sig-name descname"><span class="pre">zscore_xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.utils.zscore_xarray" title="Link to this definition"></a></dt>
<dd><p>Zscore of the data in an xarray, avoiding any nans.</p>
</dd></dl>

</section>
<section id="module-hmp.simulations">
<span id="simulations-module"></span><h2>Simulations module<a class="headerlink" href="#module-hmp.simulations" title="Link to this heading"></a></h2>
<p>Generating synthetic data to test HMP.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.available_sources">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">available_sources</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.available_sources" title="Link to this definition"></a></dt>
<dd><p>List available sources for sample subject in MNE.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.classification_true">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">classification_true</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">true_topologies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_topologies</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.classification_true" title="Link to this definition"></a></dt>
<dd><p>Classifies events as belonging to one of the true events.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>true_topologies</strong> (<em>xarray.DataArray</em>) – Topologies for the true events simulated, obtained from
<cite>utils.event_channels(epoch_data, test_estimates, mean=True)</cite>.</p></li>
<li><p><strong>test_topologies</strong> (<em>xarray.DataArray</em>) – Topologies for the events found in the estimation procedure, obtained from
<cite>utils.event_channels(epoch_data, true_estimates, true_init, mean=True)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>idx_true_positive</strong> (<em>np.ndarray</em>) – Indices of the true events found in the test estimation.</p></li>
<li><p><strong>corresp_true_idx</strong> (<em>np.ndarray</em>) – Indices in the test estimate that correspond to the true events.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.demo">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">demo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">123</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.demo" title="Link to this definition"></a></dt>
<dd><p>Create example data for the tutorials.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.event_shape">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">event_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_width_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.event_shape" title="Link to this definition"></a></dt>
<dd><p>Compute the template of a half-sine with given frequency f and sampling frequency.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.positions">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">positions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.positions" title="Link to this definition"></a></dt>
<dd><p>Recovering position of the simulated electrodes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.sfreq">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">sfreq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.sfreq" title="Link to this definition"></a></dt>
<dd><p>Recovering sampling frequency of the sample data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.sim_info">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">sim_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.sim_info" title="Link to this definition"></a></dt>
<dd><p>Recovering MNE’s info file for simulated data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.simulate">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sources</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_trials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eeg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_subj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_noiseless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_length_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.simulate" title="Link to this definition"></a></dt>
<dd><p>Simulate n_trials of EEG and/or MEG using MNE’s tools based on the specified sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sources</strong> (<em>list</em>) – <p>2D or 3D list with dimensions (n_subjects * ) sources * source_parameters.
Source parameters should contain:
- the name of the source (see the output of available_sources()).
- the duration of the event (in frequency, usually 10Hz).
- the amplitude or strength of the signal from the source, expressed in nAM (e.g., 1e-8 ).
- the duration of the preceding stage as a scipy.stats distribution</p>
<blockquote>
<div><p>(e.g., scipy.stats.gamma(a, scale)).</p>
</div></blockquote>
</p></li>
<li><p><strong>n_trials</strong> (<em>int</em>) – Number of trials to simulate.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – Number of jobs to use with MNE’s function (multithreading).</p></li>
<li><p><strong>file</strong> (<em>str</em>) – Name of the file to be saved (number of the subject will be added).</p></li>
<li><p><strong>relations</strong> (<em>list</em><em>, </em><em>optional</em>) – List of integers describing to which previous event each event is connected.
1 means stimulus, 2 means one event after stimulus, etc.
One event cannot be connected to an upcoming one.</p></li>
<li><p><strong>data_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of data to simulate. Options are “eeg”, “meg”, or “eeg/meg”. Default is “eeg”.</p></li>
<li><p><strong>n_subj</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of subjects to simulate. Default is 1.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path where to save the data. Default is the current directory.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to overwrite existing files. Default is False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display MNE’s output. Default is False.</p></li>
<li><p><strong>noise</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add noise to the simulated sources. Default is True.</p></li>
<li><p><strong>times</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Deterministic simulation of event transition times. Format is (n_sources, n_trials).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility. Default is None.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em><em>, </em><em>optional</em>) – Sampling frequency in Hz. Default is 100.0.</p></li>
<li><p><strong>save_snr</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save the signal-to-noise ratio (SNR) at peak value and electrode noise. Default is False.</p></li>
<li><p><strong>save_noiseless</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save the noiseless version of the simulated data. Default is False.</p></li>
<li><p><strong>event_length_samples</strong> (<em>list</em><em>, </em><em>optional</em>) – List of event lengths in samples for each source (e.g. to simulate longer sinewaves). Default is None.</p></li>
<li><p><strong>proportions</strong> (<em>list</em><em>, </em><em>optional</em>) – List of proportions of trials with each source. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of file names (file + number of subject) and associated metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.simulations.simulated_times_and_parameters">
<span class="sig-prename descclassname"><span class="pre">hmp.simulations.</span></span><span class="sig-name descname"><span class="pre">simulated_times_and_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generating_events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resampling_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.simulations.simulated_times_and_parameters" title="Link to this definition"></a></dt>
<dd><p>Recover the generating HMP parameters from the simulated EEG data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>generating_events</strong> (<em>np.ndarray</em>) – Times of the simulated events created by the function simulate().</p></li>
<li><p><strong>model</strong> (<em>hmp</em>) – Initialized EventModel.</p></li>
<li><p><strong>trial_data</strong> (<a class="reference internal" href="#hmp.trialdata.TrialData" title="hmp.trialdata.TrialData"><em>TrialData</em></a>) – Object containing trial-specific data such as starts, ends, and cross-correlation.</p></li>
<li><p><strong>resampling_freq</strong> (<em>float</em><em>, </em><em>optional</em>) – Value of the new sampling frequency if there is a difference between the initialized HMP
object and the generating_events. Default is None.</p></li>
<li><p><strong>data</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Alternative data to use instead of cross-correlation contained in trial_data.crosscorr. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>random_source_times</strong> (<em>np.ndarray</em>) – Index of the true events found in the test estimation.</p></li>
<li><p><strong>true_time_pars</strong> (<em>list</em>) – List of true distribution parameters (2D array: stages * parameters).</p></li>
<li><p><strong>true_channel_pars</strong> (<em>np.ndarray</em>) – 2D ndarray (n_events * components), true electrode contribution to each event.</p></li>
<li><p><strong>true_activities</strong> (<em>np.ndarray</em>) – Actual values at simulated event times.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-hmp.loocv">
<span id="loocv-module"></span><h2>LOOCV module<a class="headerlink" href="#module-hmp.loocv" title="Link to this heading"></a></h2>
<p>Module for leave-one-out crossvalidation evaluation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.backward_func">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">backward_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hmp_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_starting_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.backward_func" title="Link to this definition"></a></dt>
<dd><p>Wrap backward estimation helper.</p>
<p>Helper function for loocv_backward. Calls backward_estimation on hmp_model with provided args.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.example_complex_fit_n_func">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">example_complex_fit_n_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hmp_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mags_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.example_complex_fit_n_func" title="Link to this definition"></a></dt>
<dd><p>Fit function, complex example.</p>
<p>Example of a complex function that can be used with loocv_func.
This function first performs backwards estimation up to max_events,
and follows this with a condition-based model of n_events, informed
by the selected backward model and the provided maps. It returns
both models, so for both the likelihood will be estimated.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pars_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                     <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rep&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loocv_func</span><span class="p">(</span><span class="n">hmp_model</span><span class="p">,</span> <span class="n">hmp_data</span><span class="p">,</span> <span class="n">example_complex_fit_n_func</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="n">func_args</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pars_map</span><span class="p">,</span><span class="n">conds</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.example_fit_n_func">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">example_fit_n_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hmp_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnitudes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.example_fit_n_func" title="Link to this definition"></a></dt>
<dd><p>Fit function example.</p>
<p>Example of simple function that can be used with loocv_func.
This fits a model with n_events and potentially provided mags and params.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>   <span class="n">loocv_func</span><span class="p">(</span><span class="n">hmp_model</span><span class="p">,</span> <span class="n">hmp_data</span><span class="p">,</span> <span class="n">example_fit_single_func</span><span class="p">,</span> <span class="n">func_args</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.fit_backward_func">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">fit_backward_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hmp_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.fit_backward_func" title="Link to this definition"></a></dt>
<dd><p>Wrap fit backward function.</p>
<p>Helper function for fit_loocv_backward. Calls fit function followed by backward_estimation on
hmp_model with provided args.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.loocv">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">loocv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.loocv" title="Link to this definition"></a></dt>
<dd><p>Perform leave-one-out cross validation.</p>
<p>Performs leave-one-out cross validation. For provided estimate(s), it will perform loocv by
leaving out one participant, estimating a fit, and computing the likelihood of the data from
the left out participant with the estimated parameters. This is repeated for all participants.</p>
<p>Initial parameters for the models are based on estimate(s), hmp model settings on init.</p>
<p>Estimate(s) can be provides as:
- a single model estimate (from fit_n(..))
- a set of fits from backward estimation (from backward_estimation(..))
- a model fit with different levels
- a list of one or more of the above
Note that all need to share the same data and participants.</p>
<dl>
<dt>IMPORTANT:  This loocv procedure is incorrect in the sense that an initial estimate is used</dt><dd><p>to inform both the fit of the left-out participant and the other participants.
This means that they are not fully independent, unless the initial estimate is
based on the literature or another task. However, it does give a very good initial
idea of the correct loocv procedure, and is relatively quick.</p>
<p>To do this correctly, use loocv_backward, loocv_fit, or the general loocv_fun,
which all three also calculate the initial estimate for every fold by applying
backward estimation, the fit function, or your own function, respectively.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> (<em>hmp model</em>) – initialized hmp model</p></li>
<li><p><strong>data</strong> (<em>xarray.Dataset</em>) – xarray data from transform_data()</p></li>
<li><p><strong>estimate</strong> (<em>hmp model estimate</em><em> or </em><em>list</em><em> of </em><em>estimates</em>) – See above.</p></li>
<li><p><strong>cpus</strong> (<em>int</em>) – Nr of cpus to use. If 1, LOOCV is performed on a single CPU. Otherwise
on the provided int or setting in init.
We recommend using 1 CPU at this level on a laptop or normal PC. Only use multiple
CPUs if you have <em>a lot</em> of memory available.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
<li><p><strong>print_warning</strong> (<em>bool</em>) – whether to plot the loocv ‘incorrectness’ warning</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list of likelihood objects for provided model estimates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.loocv_backward">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">loocv_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_starting_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.loocv_backward" title="Link to this definition"></a></dt>
<dd><p>Perform leave-one-out cross validation with backward estimation.</p>
<p>Performs leave-one-out cross validation using backward_estimation to calculate the initial fit.
It will perform loocv by leaving out one participant, applying ‘backward_estimation’ to the
data to estimate a fit, and computing the likelihood of the data from the left out
participant with the estimated parameters. This is repeated for all participants.</p>
<p>Hmp model settings are based on init.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> (<em>hmp model</em>) – initialized hmp model</p></li>
<li><p><strong>data</strong> (<em>xarray.Dataset</em>) – xarray data from transform_data()</p></li>
<li><p><strong>max_events</strong> (<em>int</em>) – Maximum number of events to be estimated, by default the output of
hmp.models.HMP.compute_max_events()</p></li>
<li><p><strong>min_events</strong> (<em>int</em>) – The minimum number of events to be estimated</p></li>
<li><p><strong>max_starting_points</strong> (<em>int</em>) – how many random starting points iteration to try for the model estimating the maximal number
of events.</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>) – Tolerance applied to the expectation maximization in the EM() function</p></li>
<li><p><strong>max_iteration</strong> (<em>int</em>) – Maximum number of iteration for the expectation maximization in the EM() function</p></li>
<li><p><strong>cpus</strong> (<em>int</em>) – Nr of cpus to use. If 1, LOOCV is performed on a single CPU. Otherwise
on the provided int or setting in init.
We recommend using 1 CPU at this level on a laptop or normal PC. Only use multiple
CPUs if you have <em>a lot</em> of memory available.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>likelihood object and fitten backward estimation models</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.loocv_calcs">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">loocv_calcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.loocv_calcs" title="Link to this definition"></a></dt>
<dd><p>Fit the model and compute likelihood of left out data.</p>
<p>Fits model based on init settings and initial_fit parameters to data of
n - 1 (participant) participants, and calculates likelihood on the left-out
participant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xarray.Dataset</em>) – xarray data from transform_data()</p></li>
<li><p><strong>init</strong> (<em>hmp object</em>) – original hmp object used for the fit, all settings are copied to the left out models</p></li>
<li><p><strong>participant</strong> (<em>str</em>) – name of the participant to leave out and estimate likelihood on</p></li>
<li><p><strong>initial_fit</strong> (<em>xarray.Dataset</em>) – Fit of the model with the same number of events and all participants</p></li>
<li><p><strong>cpus</strong> (<em>int</em>) – Number of cpus to use to fit the models.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>likelihood</strong> – likelihood computed for the left-out participant</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.loocv_estimate_func">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">loocv_estimate_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_estimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.loocv_estimate_func" title="Link to this definition"></a></dt>
<dd><p>Apply function estimation.</p>
<p>Applies func_estimate with func_args to data of n - 1 (participant) participants.
func_estimate should return an estimated hmp model; either a single model,
a level model, or a backward estimation model. This model is then used
to calculate the fit on the left out participant with loocv_loglikelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xarray.Dataset</em>) – xarray data from transform_data()</p></li>
<li><p><strong>init</strong> (<em>hmp object</em>) – original hmp object used for the fit, all settings are copied to the left out models</p></li>
<li><p><strong>participant</strong> (<em>str</em>) – name of the participant to leave out</p></li>
<li><p><strong>func_estimate</strong> (<em>function that returns a hmp model estimate</em>) – this can be backward_estimation, fit, or your own function.
It should take an initialized hmp model as its first argument,
other arguments are passed on from func_args.
See also loocv_func(..)</p></li>
<li><p><strong>func_args</strong> (<em>list</em>) – List of arguments that need to be passed on to func_estimate.
See also loocv_func(..)</p></li>
<li><p><strong>cpus</strong> (<em>int</em>) – number of cpus to use</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>estimated hmp_model with func_estimate on n-1 participants</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>hmp model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.loocv_fit_backward">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">loocv_fit_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.loocv_fit_backward" title="Link to this definition"></a></dt>
<dd><p>Perform leave-one-out cross validation with fit function and backward estimation.</p>
<p>Performs leave-one-out cross validation using the fit function followed by backward_estimation
using the fit-ted model as the maximal model to calculate the initial fit.
It will perform loocv by leaving out one participant, applying ‘fit + backward_estimation’
to the data to estimate a fit, and computing the likelihood of the data from the left out
participant with the estimated parameters. This is repeated for all participants. Because the
fit function might return models with different numbers of events, loglikelihood are calculated
for models that exist for all folds.</p>
<p>Hmp model settings are based on init.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> (<em>hmp model</em>) – initialized hmp model</p></li>
<li><p><strong>data</strong> (<em>xarray.Dataset</em>) – xarray data from transform_data()</p></li>
<li><p><strong>fix_prev</strong> (<em>bool</em>) – whether to fix previous estimates in fit function (default = False)</p></li>
<li><p><strong>by_sample</strong> (<em>bool</em>) – whether to explore data sample-by-sample in fit function</p></li>
<li><p><strong>min_events</strong> (<em>int</em>) – The minimum number of events to be estimated in backward_estimation</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>) – Tolerance applied to the expectation maximization in both the fit function and
the EM() function</p></li>
<li><p><strong>max_iteration</strong> (<em>int</em>) – Maximum number of iteration for the expectation maximization in the EM() function</p></li>
<li><p><strong>cpus</strong> (<em>int</em>) – Nr of cpus to use. If 1, LOOCV is performed on a single CPU. Otherwise
on the provided int or setting in init.
We recommend using 1 CPU at this level on a laptop or normal PC. Only use multiple
CPUs if you have <em>a lot</em> of memory available.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>likelihood object and fitten backward estimation models</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.loocv_func">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">loocv_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_estimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.loocv_func" title="Link to this definition"></a></dt>
<dd><p>Perform leave one-out cross validation.</p>
<p>Performs leave-one-out cross validation using func_estimate to calculate the initial fit.
It will perform loocv by leaving out one participant, applying ‘func_estimate’ to the
data to estimate a fit, and computing the likelihood of the data from the left out
participant with the estimated parameters. This is repeated for all participants. Hmp
model settings are based on init.</p>
<p>func_estimate is also allowed to return a list of estimates; for all provided estimates
the likelihood of the left out participant will be calculated.</p>
<p>For example of func_estimate, see these function above:
example_fit_n_func(..)
example_complex_fit_n_func(..)</p>
<dl class="simple">
<dt>They can be called, for example, as</dt><dd><p>loocv_func(hmp_model, hmp_data, example_fit_n_func, func_args=[1])</p>
</dd>
</dl>
<p>Note that func_args is not named, so all arguments up to the one you want to use
of func_estimate need to be provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init</strong> (<em>hmp model</em>) – initialized hmp model</p></li>
<li><p><strong>data</strong> (<em>xarray.Dataset</em>) – xarray data from transform_data()</p></li>
<li><p><strong>func_estimate</strong> (<em>function that returns an hmp model estimate</em><em> or </em><em>a list</em>) – of hmp model estimates. These can be the results of backward_estimation,
fit_n, or your own function.
It should take an initialized hmp model as its first argument,
other arguments are passed on from func_args.</p></li>
<li><p><strong>func_args</strong> (<em>list</em>) – List of arguments that need to be passed on to func_estimate.</p></li>
<li><p><strong>cpus</strong> (<em>int</em>) – Nr of cpus to use. If 1, LOOCV is performed on a single CPU. Otherwise
on the provided int or setting in init.
We recommend using 1 CPU at this level on a laptop or normal PC. Only use multiple
CPUs if you have <em>a lot</em> of memory available.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>likelihood object containing likelihoods on left out participant</em></p></li>
<li><p><strong>estimates</strong> (<em>list of all models without the left out participant</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hmp.loocv.loocv_loglikelihood">
<span class="sig-prename descclassname"><span class="pre">hmp.loocv.</span></span><span class="sig-name descname"><span class="pre">loocv_loglikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.loocv.loocv_loglikelihood" title="Link to this definition"></a></dt>
<dd><p>Compute the log-likelihood of the fit.</p>
<p>Calculate loglikelihood of fit on participant participant using parameters from estimate,
either using single model or level based model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xarray.Dataset</em>) – xarray data from transform_data()</p></li>
<li><p><strong>init</strong> (<em>hmp object</em>) – original hmp object used for the fit, all settings are copied to the left out models</p></li>
<li><p><strong>participant</strong> (<em>str</em>) – name of the participant to leave out and estimate likelihood on</p></li>
<li><p><strong>estimate</strong> (<em>xarray.Dataset</em>) – estimate that has parameters to apply.</p></li>
<li><p><strong>cpus</strong> (<em>int</em>) – Number of cpus to use to fit the models.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>likelihood</strong> – likelihood computed for the left-out participant</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-hmp.mcca">
<span id="mcca-module"></span><h2>MCCA module<a class="headerlink" href="#module-hmp.mcca" title="Link to this heading"></a></h2>
<p>Adapted from <a class="reference external" href="https://github.com/ANCPLabOldenburg/MCCA/blob/main/README.md">https://github.com/ANCPLabOldenburg/MCCA/blob/main/README.md</a>.</p>
<p>Author/maintainer: Leo Michalke <a class="reference external" href="https://github.com/lmichalke">https://github.com/lmichalke</a></p>
<p>MIT License</p>
<p>Copyright (c) 2022 Applied Neurocognitive Psychology Lab University Oldenburg</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the “Software”), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>
<dl class="py class">
<dt class="sig sig-object py" id="hmp.mcca.MCCA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">hmp.mcca.</span></span><span class="sig-name descname"><span class="pre">MCCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components_pca</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components_mcca</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pca_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.mcca.MCCA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Performs multiset canonical correlation analysis.</p>
<p>with an optional regularization term based on spatial similarity of weight maps. The
stronger the regularization, the more similar weight maps are forced to
be across subjects. Note that the term ‘weights’ is used interchangeably
with PCA / MCCA eigenvectors here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>int</strong><strong>)</strong> (<em>n_components_mcca</em>)</p></li>
<li><p><strong>(</strong><strong>int</strong><strong>)</strong></p></li>
<li><p><strong>(</strong><strong>bool</strong><strong>)</strong> (<em>pca_only</em>)</p></li>
<li><p><strong>float</strong><strong>)</strong> (<em>r</em><em> (</em><em>int or</em>)</p></li>
<li><p><strong>(</strong><strong>bool</strong><strong>)</strong></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.mcca.MCCA.mu">
<span class="sig-name descname"><span class="pre">mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.mcca.MCCA.mu" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mean subtracted before PCA (subjects, sensors)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.mcca.MCCA.sigma">
<span class="sig-name descname"><span class="pre">sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.mcca.MCCA.sigma" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PCA standard deviation (subjects, PCs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.mcca.MCCA.pca_weights">
<span class="sig-name descname"><span class="pre">pca_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.mcca.MCCA.pca_weights" title="Link to this definition"></a></dt>
<dd><p>subject (subjects, sensors, PCs)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PCA weights that transform sensors to PCAs for each</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmp.mcca.MCCA.mcca_weights">
<span class="sig-name descname"><span class="pre">mcca_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.mcca.MCCA.mcca_weights" title="Link to this definition"></a></dt>
<dd><p>None if pca_only is True. (subjects, PCs, CCs)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MCCA weights that transform PCAs to MCCAs for each subject.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.mcca.MCCA.obtain_mcca">
<span class="sig-name descname"><span class="pre">obtain_mcca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.mcca.MCCA.obtain_mcca" title="Link to this definition"></a></dt>
<dd><p>Apply individual-subject PCA and across-subjects MCCA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>(</strong><strong>ndarray</strong><strong>)</strong> (<em>X</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>scores (ndarray): Returns scores in PCA space if self.pca_only is true
and MCCA scores otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.mcca.MCCA.obtain_mcca_cov">
<span class="sig-name descname"><span class="pre">obtain_mcca_cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.mcca.MCCA.obtain_mcca_cov" title="Link to this definition"></a></dt>
<dd><p>Apply individual-subject PCA on the variance-covariance matrix and across-subjects MCCA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>(</strong><strong>ndarray</strong><strong>)</strong> (<em>X</em>) – Input data in sensor space for each trial (subjects, n_trials, samples, sensors)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns scores in PCA space if self.pca_only is true and MCCA scores otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scores (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmp.mcca.MCCA.transform_trials">
<span class="sig-name descname"><span class="pre">transform_trials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#hmp.mcca.MCCA.transform_trials" title="Link to this definition"></a></dt>
<dd><p>Transform single trial data to MCCA space.</p>
<p>Use of MCCA weights (obtained from averaged data) to transform single
trial data from sensor space to MCCA space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>ndarray</strong><strong>)</strong> (<em>X</em>) – (trials, samples, sensors)</p></li>
<li><p><strong>(</strong><strong>int</strong><strong>)</strong> (<em>subject</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>X_mcca (ndarray): Transformed single trial data in MCCA space</dt><dd><p>(trials, samples, CCs)</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../installation.html" class="btn btn-neutral float-left" title="Installation Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hmp.models.html" class="btn btn-neutral float-right" title="Eliminative estimation method" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Gabriel Weindel, Maarten Schermer, Raoul Schram, Leendert van Maanen, Jelmer Borst.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>